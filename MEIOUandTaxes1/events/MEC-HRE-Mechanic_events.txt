### Created by Beorsferth ###

#######################################################
###		##001 HOFTAG / REICHSTAG RELATED EVENTS		###
###		##002 Estate Interaction Events				###
###		##003 KINGDOM MENUES						###
#######################################################

namespace = HRE_mechanics

####################################
### 001 HOFTAG MECHANICAL EVENTS ###
####################################

###Imperial Decisions Menue
country_event = {
	id = HRE_mechanics.100
	title = HRE_mechanics.100.t
	desc = HRE_mechanics.100.d
	is_triggered_only = yes
	hidden = no
	picture = HRE_eventPicture
	
	immediate = {
		#Set_Display_HRE_Overview = yes
	}

	after = {
		#clean_Display_HRE_Overview = yes
	}
	
	#Call for a imperial Hoftag
	option = {
		name = "HRE_mechanics.100.a"
		trigger = { 
			NOT = { has_global_flag = HRE_INST_RT_A }  ### No longer able to call for imperial Hoftag when it got reformed into the Reichstag
		}
		country_event = {
			id = HRE_mechanics.200
		}
	}

	
	option = {
		name = exit
		highlight = yes

		ai_chance = {
			factor = 0
		}
	}
}

###Test event
country_event = {
	id = HRE_mechanics.101
	title = HRE_mechanics.101.t
	desc = HRE_mechanics.101.d
	is_triggered_only = yes
	hidden = no
	picture = HRE_eventPicture
	
	immediate = {
	}
	
	option = {
		name = "HRE_mechanics.101_a"
		trigger = { } 
		Hoftag_Setup_Script = {
			who = everyone
			where = Nuernberg
			agenda1 = Trib
			agenda2 = Consc
			agenda3 = Centr
		}
	}	
	
	option = {
		name = exit
		highlight = yes

		ai_chance = {
			factor = 0
		}
	}
}

### Call for Hoftag Main event menu	
country_event = {
	id = HRE_mechanics.200
	title = HRE_mechanics.200.t
	desc = HRE_mechanics.200.d
	picture = HRE_eventPicture

	hidden = no
	
	is_triggered_only = yes
	
	option = {
		name = "HRE_mechanics.200.choose_who_to_invite"
		trigger = {
			NOT = { has_country_flag = Hft_Inv_Setup }
		}
		country_event = {
			id = HRE_mechanics.201
		}
	}
	
	option = {
		name = "HRE_mechanics.200.choose_the_place"
		trigger = {
			NOT = { has_country_flag = Hft_Place_Setup }
		}
		country_event = {
			id = HRE_mechanics.202
		}
	}

	option = {
		name = "HRE_mechanics.200.choose_the_agenda"
		trigger = {
			NOT = { has_country_flag = Hft_Agen_Setup }
		}
		country_event = {
			id = HRE_mechanics.203
		}
	}
	
	
	option = {
		name = "HRE_mechanics.200.finish_hoftag_preparations"
		highlight = yes
		
		trigger = {
			AND = {
				has_country_flag = Hft_Place_Setup
				has_country_flag = Hft_Inv_Setup
				has_country_flag = Hft_Agen_Setup
			}	
		}	
		country_event = {
			id = HRE_mechanics.300
		}
		
		set_country_flag = Hft_Setup
		clr_country_flag = Hft_Place_Setup
		clr_country_flag = Hft_Inv_Setup
		clr_country_flag = Hft_Agen_Setup

	}
}	
	
	
### Choose who to invite to hoftag
country_event = {
	id = HRE_mechanics.201
	title = HRE_mechanics.201.t
	desc = HRE_mechanics.201.d
	picture = HRE_eventPicture

	hidden = no
	
	is_triggered_only = yes
	
	option = {
		name = "HRE_mechanics.201.everyone"
		
		### Meta Script - See hre_mechanics scripted effects file
		Hoftag_Invitation = { who = everyone }
		set_country_flag = Hft_Inv_Setup
		
		country_event = { id = HRE_mechanics.200 } ### Hft Menue event
	}
	
	option = {
		name = "HRE_mechanics.201.a"
		trigger = { NOT = { has_country_flag = Hft_Inv_Elec } }
		set_country_flag = Hft_Inv_Elec
		
		country_event = { id = HRE_mechanics.2011 } ### Mirror event
		
		### Meta Script - See hre_mechanics scripted effects file
		Hoftag_Invitation = { who = imperial_electors }
	}
	
	option = {
		name = "HRE_mechanics.201.b"
		trigger = { NOT = { has_country_flag = Hft_Inv_Prin } }
		set_country_flag = Hft_Inv_Prin
		
		country_event = { id = HRE_mechanics.2011 } ### Mirror event
		
		### Meta Script - See hre_mechanics scripted effects file
		Hoftag_Invitation = { who = imperial_princes }
	}
	
	option = {
		name = "HRE_mechanics.201.c"
		trigger = { NOT = { has_country_flag = Hft_Inv_Counts } }
		set_country_flag = Hft_Inv_Counts
		
		country_event = { id = HRE_mechanics.2011 } ### Mirror event
		
		### Meta Script - See hre_mechanics scripted effects file
		Hoftag_Invitation = { who = imperial_counts }
	}
	
	
	option = {
		name = "HRE_mechanics.201.d1"
		trigger = { NOT = { has_country_flag = Hft_Inv_Cities } }
		set_country_flag = Hft_Inv_Cities
		
		country_event = { id = HRE_mechanics.2011 }	### Mirror event
		
		### Meta Script - See hre_mechanics scripted effects file
		Hoftag_Invitation = { who = imperial_cities }
	}
	
	option = {
		name = "HRE_mechanics.201.e"
		trigger = { NOT = { has_country_flag = Hft_Inv_Bisho } }
		set_country_flag = Hft_Inv_Bisho
		
		country_event = { id = HRE_mechanics.2011 } ### Mirror event
		
		### Meta Script - See hre_mechanics scripted effects file
		Hoftag_Invitation = { who = imperial_electors }
		
	}
	
	option = {
		name = "HRE_mechanics.201.finish"
		highlight = yes
		
		trigger = {
			OR = {
			      has_country_flag = Hft_Inv_Elec
			      has_country_flag = Hft_Inv_Cities
			      has_country_flag = Hft_Inv_Counts
			      has_country_flag = Hft_Inv_Prin
				  has_country_flag = Hft_Inv_Bisho
			}
		}
		set_country_flag = Hft_Inv_Setup
		clr_country_flag = Hft_Inv_Elec
		clr_country_flag = Hft_Inv_Cities
		clr_country_flag = Hft_Inv_Counts
		clr_country_flag = Hft_Inv_Prin
        clr_country_flag = Hft_Inv_Bisho
						   
		country_event = {
			id = HRE_mechanics.200 ### Hft Menue event
		}	
	}
}

### MIRROR: Choose who to invite to hoftag
country_event = {
	id = HRE_mechanics.2011
	title = HRE_mechanics.2011.t
	desc = HRE_mechanics.2011.d
	picture = HRE_eventPicture

	hidden = no
	
	is_triggered_only = yes
	
	option = {
		name = "HRE_mechanics.2011.everyone"
		
		### Meta Script - See hre_mechanics scripted effects file
		Hoftag_Invitation = { who = everyone }
		set_country_flag = Hft_Inv_Setup
		
		country_event = { id = HRE_mechanics.200 } ### Hft Menue event
	}
	
	option = {
		name = "HRE_mechanics.2011.a"
		trigger = { NOT = { has_country_flag = Hft_Inv_Elec } }
		set_country_flag = Hft_Inv_Elec
		
		country_event = { id = HRE_mechanics.201 } ### Mirror event
		
		### Meta Script - See hre_mechanics scripted effects file
		Hoftag_Invitation = { who = imperial_electors }
	}
	
	option = {
		name = "HRE_mechanics.2011.b"
		trigger = { NOT = { has_country_flag = Hft_Inv_Prin } }
		set_country_flag = Hft_Inv_Prin
		
		country_event = { id = HRE_mechanics.201 } ### Mirror event
		
		### Meta Script - See hre_mechanics scripted effects file
		Hoftag_Invitation = { who = imperial_princes }
	}
	
	option = {
		name = "HRE_mechanics.2011.c"
		trigger = { NOT = { has_country_flag = Hft_Inv_Counts } }
		set_country_flag = Hft_Inv_Counts
		
		country_event = { id = HRE_mechanics.201 } ### Mirror event
		
		### Meta Script - See hre_mechanics scripted effects file
		Hoftag_Invitation = { who = imperial_counts }
	}
	
	
	option = {
		name = "HRE_mechanics.2011.d1"
		trigger = { NOT = { has_country_flag = Hft_Inv_Cities } }
		set_country_flag = Hft_Inv_Cities
		
		country_event = { id = HRE_mechanics.201 }	### Mirror event
		
		### Meta Script - See hre_mechanics scripted effects file
		Hoftag_Invitation = { who = imperial_cities }
	}
	
	option = {
		name = "HRE_mechanics.2011.e"
		trigger = { NOT = { has_country_flag = Hft_Inv_Bisho } }
		set_country_flag = Hft_Inv_Bisho
		
		country_event = { id = HRE_mechanics.201 } ### Mirror event
		
		### Meta Script - See hre_mechanics scripted effects file
		Hoftag_Invitation = { who = imperial_electors }
		
	}
	
	option = {
		name = "HRE_mechanics.2011.finish"
		highlight = yes
		
		trigger = {
			OR = {
			      has_country_flag = Hft_Inv_Elec
			      has_country_flag = Hft_Inv_Cities
			      has_country_flag = Hft_Inv_Counts
			      has_country_flag = Hft_Inv_Prin
				  has_country_flag = Hft_Inv_Bisho
			}
		}
		set_country_flag = Hft_Inv_Setup
		clr_country_flag = Hft_Inv_Elec
		clr_country_flag = Hft_Inv_Cities
		clr_country_flag = Hft_Inv_Counts
		clr_country_flag = Hft_Inv_Prin
        clr_country_flag = Hft_Inv_Bisho
						   
		country_event = {
			id = HRE_mechanics.200 ### Hft Menue event
		}	
	}
}

### Choose place for the hoftag
country_event = {
	id = HRE_mechanics.202
	title = HRE_mechanics.202.t
	desc = HRE_mechanics.202.d
	hidden = no
	picture = HRE_eventPicture

	
	is_triggered_only = yes

	option = {
		name = "HRE_mechanics.202.choose_capital"
		
		Hoftag_Site_Chosing = { where = Capital }
				
		country_event = { id = HRE_mechanics.200 }
	}
	
	option = {
		name = "HRE_mechanics.202.choose_aachen"
		trigger = {
			4009 = {
				owner = { 
					tag = AAC
					has_country_flag = imperial_city
				}
			}		
		}
		
		### Meta Script - See hre_mechanics scripted effects file
		Hoftag_Site_Chosing = { where = Aachen }

		country_event = { id = HRE_mechanics.200 }
	}
	
	option = {
		name = "HRE_mechanics.202.choose_frankfurt"
		trigger = {
			1365 = {
				owner = { 
					tag = FRF
					has_country_flag = imperial_city
				}
			}	
		}

		### Meta Script - See hre_mechanics scripted effects file
		Hoftag_Site_Chosing = { where = Frankfurt }
		
		country_event = { id = HRE_mechanics.200 }
	}
	
	option = {
		name = "HRE_mechanics.202.choose_nuernberg"
		trigger = {
			81 = {
				owner = { 
					tag = NUR
					has_country_flag = imperial_city
				}
			}		
		}
		
		### Meta Script - See hre_mechanics scripted effects file
		Hoftag_Site_Chosing = { where = Nuernberg }
		
		country_event = {
			id = HRE_mechanics.200
		}
	}
	option = {
		name = "HRE_mechanics.202.choose_random"
		trigger = {
			calc_true_if = {
				any_country = {
					has_country_flag = imperial_city
					is_part_of_hre = yes
				}
				amount = 1
			}
		}
		
		### Meta Script - See hre_mechanics scripted effects file
		Hoftag_Site_Chosing = { where = Random }
		
		country_event = { id = HRE_mechanics.200 } ## Back to Menu
	}
}


###### Agenda for Hoftag
country_event = {
	id = HRE_mechanics.203
	title = HRE_mechanics.203.t
	desc = HRE_mechanics.203.d
	picture = HRE_eventPicture

	hidden = no
	
	is_triggered_only = yes
	
	immediate = {}
	
	### Imperial Tribute --> Money for the Emperor - based on amount of members
	option = {
		name = "HRE_mechanics.203.imperial_tribute"
		trigger = {
			### Meta Trigger - See hre_mechanics scripted trigger file
			Hoftag_Add_Agenda_Topic_Trigger = { topic = Trib }
		}
		### Meta Script - See hre_mechanics scripted effects file
		Hoftag_Add_Agenda_Topic = { topic = Trib }
		
		country_event = { id = HRE_mechanics.2031 }		
	}

	### Imperial Conscription --> Manpower + Forcelimit - based on amount of members
	option = {
		name = "HRE_mechanics.203.Imperial_Conscription"
		trigger = {
			### Meta Trigger - See hre_mechanics scripted trigger file
			Hoftag_Add_Agenda_Topic_Trigger = { topic = Consc }
		}
		### Meta Script - See hre_mechanics scripted effects file
		Hoftag_Add_Agenda_Topic = { topic = Consc }
		
		country_event = { id = HRE_mechanics.2031 }	##Mirror event
	}

	### Imperial Centralize --> increase IA, decrease opinion with empire, increase imperial adm reform desire
	option = {
		name = "HRE_mechanics.203.Imperial_Centralization"
		trigger = {
			### Meta Trigger - See hre_mechanics scripted trigger file
			Hoftag_Add_Agenda_Topic_Trigger = { topic = Centr }
		}
		### Meta Script - See hre_mechanics scripted effects file
		Hoftag_Add_Agenda_Topic = { topic = Centr }
		
		country_event = { id = HRE_mechanics.2031 }	##Mirror event
		
	}
	
	option = {
		name = "HRE_mechanics.203.agenda_finished"
		highlight = yes
		trigger = {	ERG = { check_key = { lhs = Hft_Agen value = 1 } }
		}
		set_country_flag = Hft_Agen_Setup
		
		country_event = { id = HRE_mechanics.200 }
	}
	
	
	option = {
		name = "Back"
		country_event = { id = HRE_mechanics.200 }
	}
	
}

###### Agenda for Hoftag 
country_event = {
	id = HRE_mechanics.2031
	title = HRE_mechanics.2031.t
	desc = HRE_mechanics.2031.d
	picture = HRE_eventPicture

	hidden = no
	
	is_triggered_only = yes
	
	immediate = {
	}
	
	### Imperial Tribute --> Money for the Emperor - based on amount of members
	option = {
		name = "HRE_mechanics.2031.imperial_tribute"
		trigger = {
			### Meta Trigger - See hre_mechanics scripted trigger file
			Hoftag_Add_Agenda_Topic_Trigger = { topic = Trib }
		}
		### Meta Script - See hre_mechanics scripted effects file
		Hoftag_Add_Agenda_Topic = { topic = Trib }
		
		country_event = { id = HRE_mechanics.203 }		
	}

	### Imperial Conscription --> Manpower + Forcelimit - based on amount of members
	option = {
		name = "HRE_mechanics.2031.Imperial_Conscription"
		trigger = {
			### Meta Trigger - See hre_mechanics scripted trigger file
			Hoftag_Add_Agenda_Topic_Trigger = { topic = Consc }
		}
		### Meta Script - See hre_mechanics scripted effects file
		Hoftag_Add_Agenda_Topic = { topic = Consc }
		
		country_event = { id = HRE_mechanics.203 }	##Mirror event
	}

	### Imperial Centralize --> increase IA, decrease opinion with empire, increase imperial adm reform desire
	option = {
		name = "HRE_mechanics.2031.Imperial_Centralization"
		trigger = {
			### Meta Trigger - See hre_mechanics scripted trigger file
			Hoftag_Add_Agenda_Topic_Trigger = { topic = Centr }
		}
		### Meta Script - See hre_mechanics scripted effects file
		Hoftag_Add_Agenda_Topic = { topic = Centr }
		
		country_event = { id = HRE_mechanics.203 }	##Mirror event
		
	}
	
	option = {
		name = "HRE_mechanics.2031.agenda_finished"
		highlight = yes
		trigger = {	ERG = { check_key = { lhs = Hft_Agen value = 1 } }
		}
		set_country_flag = Hft_Agen_Setup
		
		country_event = { id = HRE_mechanics.200 }
	}	
	
	option = {
		name = "EXIT"
		country_event = { id = HRE_mechanics.200 }
	}
	
}
	
### SEND INVITES TO INVITED HRE MEMBERS
country_event = {
	id = HRE_mechanics.300
	title = HRE_mechanics.300.t
	desc = HRE_mechanics.300.d
	hidden = yes
	is_triggered_only = yes
	picture = HRE_eventPicture
	
	immediate = {
	
		every_country = {
			limit = {
				has_country_flag = Hft_Invited
			}
			
			country_event = {
				id = HRE_mechanics.400
			}	
		}
		
		every_country = {
			limit = {
				capital_scope = { has_province_modifier = hoftag_site }			
			}
			
			country_event = { id = HRE_mechanics.302 days = 105 }	
		}
	}
}


### hoftag starts 
country_event = {
	id = HRE_mechanics.302
	title = HRE_mechanics.302.t
	desc = HRE_mechanics.302.d
	hidden = yes
	picture = HRE_eventPicture
	
	is_triggered_only = yes
	
	
	trigger = { 
		emperor = {
			has_country_flag = Hft_Setup
		}
		capital_scope = { has_province_modifier = hoftag_site }
		capital_scope = { NOT = { has_province_modifier = hoftag_preparation_timer } }
	}
	
	immediate = {
		emperor = {
			country_event = {
				id = HRE_mechanics.402
			}			
		
			clr_country_flag = Hft_Setup
			set_country_flag = Hft_Phase_1
		}		
	}
	
	option = {
	
	}
}

### Event for invited princes to join the hoftag and choose to either support or opppose the emperor.
country_event = {
	id = HRE_mechanics.400
	title = HRE_mechanics.400.t
	desc = HRE_mechanics.400.d
	hidden = no
	is_triggered_only = yes
	picture = HRE_eventPicture
	
	option = { ### support the emperor
		name = "HRE_mechanics.400.go_to_the_hoftag_support"
	
		ai_chance = {
			factor = 50
			modifier = {
				emperor = { reverse_has_opinion = { who = ROOT value = 150 } }
				factor = 2.25
			}
			modifier = {
				emperor = { reverse_has_opinion = { who = ROOT value = 125 } }
				factor = 2.0                                               
			}                                                              
			modifier = {                                                   
				emperor = { reverse_has_opinion = { who = ROOT value = 100 } }
				factor = 1.75
			}
			modifier = {
				emperor = { reverse_has_opinion = { who = ROOT value = 75 } }
				factor = 1.5                                              
			}                                                             
			modifier = {                                                  
				emperor = { reverse_has_opinion = { who = ROOT value = 50 } }
				factor = 1.25                                             
			}                                                             
			modifier = {                                                  
				emperor = { reverse_has_opinion = { who = ROOT value = 25 } }
				factor = 1.0
			}
			modifier = {
				emperor = { reverse_has_opinion = { who = ROOT value = 0 } }
				factor = 0.9	
			}
			modifier = {
				emperor = { diplomatic_reputation = 1 }
				factor = 1.05
			}
			modifier = {
				emperor = { diplomatic_reputation = 2 }
				factor = 1.2
			}
			modifier = {
				emperor = { diplomatic_reputation = 3 }
				factor = 1.5
			}
			modifier = {
				emperor = { has_country_flag = formalize_reichstag }
				factor = 2
			}
			modifier = {
				 emperor = {
					AND = {
						has_country_flag = Hft_Agen_Streng 
						NOT = { DIP = 1 }
					}
				}
				factor = 0.1
			}
			modifier = {
				 emperor = {
					AND = {
						has_country_flag = Hft_Agen_Streng 
						NOT = { DIP = 2 }
					}
				}
				factor = 0.2
			}
			modifier = {
				 emperor = {
					AND = {
						has_country_flag = Hft_Agen_Streng 
						NOT = { DIP = 3 }
					}
				}
				factor = 0.3
			}
			modifier = {
				 emperor = {
					AND = {
						has_country_flag = Hft_Agen_Streng 
						DIP = 3
					}
				}
				factor = 1.05
			}
			modifier = {
				 emperor = {
					AND = {
						has_country_flag = Hft_Agen_Streng 
						DIP = 4
					}
				}
				factor = 1.2
			}
			modifier = {
				 emperor = {
					AND = {
						has_country_flag = Hft_Agen_Streng 
						DIP = 5
					}
				}
				factor = 1.4
			}
			modifier = {
				 emperor = {
					AND = {
						has_country_flag = Hft_Agen_Streng 
						DIP = 5
					}
				}
				factor = 1.6
			}
			modifier = {
				emperor = {
					has_country_flag = Hft_Agen_Defense_1
				}
				factor = 1.5
			}
		}
	
		clr_country_flag = Hft_Invitation
		
		trigger_switch = {
			on_trigger = has_country_flag
			imperial_elector   = { ERG = { change_key = { lhs = Hft_Vote_Sup value = 2 } } }
			imperial_prince    = { ERG = { change_key = { lhs = Hft_Vote_Sup value = 1 } } }
			imperial_bishopric = { ERG = { change_key = { lhs = Hft_Vote_Sup value = 1 } } }
			imperial_count     = { ERG = { change_key = { lhs = Hft_Vote_Sup value = 0.5 } } }
			imperial_city	   = { ERG = { change_key = { lhs = Hft_Vote_Sup value = 0.5 } } }
		}   
	}
	
	option = { ### oppose the emperor
		name = "HRE_mechanics.400.go_to_the_hoftag_oppose"
	
		ai_chance = {
			factor = 50
			modifier = {
				emperor = { has_country_flag = formalize_prefer_counts }
				factor = 1.5
			}
			modifier = {
				emperor = { has_country_flag = formalize_prefer_cities }
				factor = 1.5
			}
			modifier = {
				emperor = { has_country_flag = Hft_Agen_Streng_mil }
				factor = 1.25
			}
			modifier = {
				emperor = { has_country_flag = Hft_Agen_Streng_adm }
				factor = 1.25
			}
			modifier = {
				num_of_cities = 1
				factor = 0.5
			}			
			modifier = {
				num_of_cities = 2
				factor = 0.6               
			}                              
			modifier = {                   
				num_of_cities = 3 
				factor = 0.7              
			}                              
			modifier = {                   
				num_of_cities = 4 
				factor = 1.0               
			}                              
			modifier = {                   
				num_of_cities = 5 
				factor = 1.1              
			}			                   
			modifier = {                   
				num_of_cities = 6 
				factor = 1.3              
			}                              
			modifier = {                   
				num_of_cities = 7 
				factor = 1.6               
			}                              
			modifier = {                   
				num_of_cities = 8		
				factor = 2               
			}                              
			modifier = {                   
				num_of_cities = 9 
				factor = 2.5               
			}	                           
			modifier = {                   
				num_of_cities = 10
				factor = 3
			}
			modifier = {
				ERG = { check_key = { lhs = Hft_Agen value = 2 } }
				factor = 1.1
			}
			modifier = {
				ERG = { check_key = { lhs = Hft_Agen value = 3 } }
				factor = 1.1
			}
		}
		
		clr_country_flag = Hft_Invitation
		
		trigger_switch = {
			on_trigger = has_country_flag
			imperial_elector   = { ERG = { change_key = { lhs = Hft_Vote_Opp value = 2 } } }
			imperial_prince    = { ERG = { change_key = { lhs = Hft_Vote_Opp value = 1 } } }
			imperial_bishopric = { ERG = { change_key = { lhs = Hft_Vote_Opp value = 1 } } }
			imperial_count     = { ERG = { change_key = { lhs = Hft_Vote_Opp value = 0.5 } } }
			imperial_city	   = { ERG = { change_key = { lhs = Hft_Vote_Opp value = 0.5 } } }
		}
						
	}
	
	option = { ### dont go to hoftag.
		name = "HRE_mechanics.400.Refuse_to_go_to_the_hoftag"
		
		ai_chance = {
			factor = 25
			modifier = {
				emperor = { has_country_flag = formalize_reichstag }
				factor = 0.01
			}
			modifier = {
				NOT = {  emperor = { reverse_has_opinion = { who = ROOT value = -25 } }  }
				factor = 1.25                                                             
			}                                                                            
			modifier = {                                                                 
				NOT = {  emperor = { reverse_has_opinion = { who = ROOT value = -50 } }  }
				factor = 1.5                                                            
			}                                                                            
			modifier = {                                                                 
				NOT = {  emperor = { reverse_has_opinion = { who = ROOT value = -75 } }  }
				factor = 1.75                                                               
			}                                                                            
			modifier = {                                                                 
				NOT = {  emperor = { reverse_has_opinion = { who = ROOT value = -100 } } }
				factor = 2                                                            
			}                                                                            
			modifier = {                                                                 
				NOT = {  emperor = { reverse_has_opinion = { who = ROOT value = -125 } } }
				factor = 2.5                                                            
			}                                                                            
			modifier = {                                                                 
				NOT = {  emperor = { reverse_has_opinion = { who = ROOT value = -150 } } }
				factor = 3                                                             
			}                                                                            
			modifier = {                                                                 
				NOT = {  emperor = { reverse_has_opinion = { who = ROOT value = -175 } } }
				factor = 3.5                                                             
			}                                                                            
			modifier = {                                                                 
				NOT = {  emperor = { reverse_has_opinion = { who = ROOT value = -200 } } }
				factor = 4
			}
		}
		
		clr_country_flag = Hft_Invitation
		
		trigger_switch = {
			on_trigger = has_country_flag
			imperial_elector   = { ERG = { change_key = { lhs = Hft_Vote_Ref value = 2 } } }
			imperial_prince    = { ERG = { change_key = { lhs = Hft_Vote_Ref value = 1 } } }
			imperial_bishopric = { ERG = { change_key = { lhs = Hft_Vote_Ref value = 1 } } }
			imperial_count     = { ERG = { change_key = { lhs = Hft_Vote_Ref value = 0.5 } } }
			imperial_city	   = { ERG = { change_key = { lhs = Hft_Vote_Ref value = 0.5 } } }
		}
		
		
		add_opinion = { who = FROM modifier = refused_to_go_to_hoftag }	
		add_prestige = -20
		
	}	
}

##### HOFTAG REACTION TO INVITATION
country_event = {
	id = HRE_mechanics.402
	title = HRE_mechanics.402.t
	desc = HRE_mechanics.402.d
	hidden = no
	is_triggered_only = yes
	picture = HRE_eventPicture


	immediate = {
		hidden_effect = {
			ERG = {
				set_key = { lhs = Hft_Infl_Mod value = 1 }
				
				### Calc Total Value
				set_key = { lhs = Hft_Votes value = 0 }
				change_key = { lhs = Hft_Votes which = Hft_Vote_Sup }
				change_key = { lhs = Hft_Votes which = Hft_Vote_Opp }
				change_key = { lhs = Hft_Votes which = Hft_Vote_Ref }
				
				### Calc Support %
				change_key = { lhs = Hft_Sup_Perc which = Hft_Vote_Sup }
				divide_key = { lhs = Hft_Sup_Perc which = Hft_Votes }
				multiply_key = { lhs = Hft_Sup_Perc value = 100 }
				
				### Calc Oppose %
				change_key = { lhs = Hft_Opp_Perc which = Hft_Vote_Opp }
				divide_key = { lhs = Hft_Opp_Perc which = Hft_Votes }
				multiply_key = { lhs = Hft_Opp_Perc value = 100 }
			
				### Calc Refuse %
				change_key = { lhs = Hft_Ref_Perc which = Hft_Vote_Ref }
				divide_key = { lhs = Hft_Ref_Perc which = Hft_Votes }
				multiply_key = { lhs = Hft_Ref_Perc value = 100 }			
			}	
		}
		trigger_switch = {
			on_trigger = has_country_flag
			Hft_Agen_Centr_1 = { custom_tooltip = HRE_mechanics.402.CTP1_Centr }
			Hft_Agen_Consc_1 = { custom_tooltip = HRE_mechanics.402.CTP1_Consc }
			Hft_Agen_Trib_1  = { custom_tooltip = HRE_mechanics.402.CTP1_Trib  }
			Hft_Agen_Defense_1 = { custom_tooltip = HRE_mechanics.402.CTP1_Defen }
			Hft_Agen_Reichstag_1 = { custom_tooltip = HRE_mechanics.402.CTP1_Reichstag }
			Hft_Agen_Romzug_1 = { custom_tooltip = HRE_mechanics.402.CTP1_Romzug }
		}
		trigger_switch = {
			on_trigger = has_country_flag
			Hft_Agen_Centr_2 = { custom_tooltip = HRE_mechanics.402.CTP2_Centr }
			Hft_Agen_Consc_2 = { custom_tooltip = HRE_mechanics.402.CTP2_Consc }
			Hft_Agen_Trib_2  = { custom_tooltip = HRE_mechanics.402.CTP2_Trib  }
		}
		trigger_switch = {
			on_trigger = has_country_flag
			Hft_Agen_Centr_3 = { custom_tooltip = HRE_mechanics.402.CTP3_Centr }
			Hft_Agen_Consc_3 = { custom_tooltip = HRE_mechanics.402.CTP3_Consc }
			Hft_Agen_Trib_3  = { custom_tooltip = HRE_mechanics.402.CTP3_Trib  }
		}	
	}
	
	option = {
		name = "HRE_mechanics.402.a"
		country_event = { id = HRE_mechanics.410 }
	}

}

##### HOFTAG Phase event
country_event = {
	id = HRE_mechanics.410
	title = "HRE_mechanics.410.t"
	#title = { title = "HRE_mechanics.410.t_phase2"  trigger = { has_country_flag = Hft_Phase_2 } }
	#title = { title = "HRE_mechanics.410.t_phase3"  trigger = { has_country_flag = Hft_Phase_3 } }
	desc = { desc = "HRE_mechanics.410.d_Hft_Agen_Centr_1" trigger = { has_country_flag = Hft_Agen_Centr_1 } }
	desc = { desc = "HRE_mechanics.410.d_Hft_Agen_Consc_1" trigger = { has_country_flag = Hft_Agen_Consc_1 } }
	desc = { desc = "HRE_mechanics.410.d_Hft_Agen_Trib_1"  trigger = { has_country_flag = Hft_Agen_Trib_1  } }
	desc = { desc = "HRE_mechanics.410.d_Hft_Agen_Centr_2" trigger = { has_country_flag = Hft_Agen_Centr_2 } }
	desc = { desc = "HRE_mechanics.410.d_Hft_Agen_Consc_2" trigger = { has_country_flag = Hft_Agen_Consc_2 } }
	desc = { desc = "HRE_mechanics.410.d_Hft_Agen_Trib_2"  trigger = { has_country_flag = Hft_Agen_Trib_2  } }
	desc = { desc = "HRE_mechanics.410.d_Hft_Agen_Centr_2" trigger = { has_country_flag = Hft_Agen_Centr_3 } }
	desc = { desc = "HRE_mechanics.410.d_Hft_Agen_Consc_2" trigger = { has_country_flag = Hft_Agen_Consc_3 } }
	desc = { desc = "HRE_mechanics.410.d_Hft_Agen_Trib_3"  trigger = { has_country_flag = Hft_Agen_Trib_3  } }
	###Special Cases
	desc = { desc = "HRE_mechanics.410.d_Hft_Agen_Reichstag"  trigger = { has_country_flag = Hft_Agen_Reichstag_1 } }
	desc = { desc = "HRE_mechanics.410.d_Hft_Agen_Defense" trigger = { has_country_flag = Hft_Agen_Defense_1 } }
	desc = { desc = "HRE_mechanics.410.d_Hft_Agen_Romzug" trigger = { has_country_flag = Hft_Agen_Romzug_1 } }
	
	picture = HRE_eventPicture
	hidden = no
	is_triggered_only = yes
	
	option = {
		name = "HRE_mechanics.410.Bribe_MP"
		trigger = { 
			adm_power = 50
			dip_power = 50
			mil_power = 50				
		}
		hidden_effect = { country_event = { id = HRE_mechanics.411 } }
		custom_tooltip = "HRE_mechanics.410.CTP_Bribe_MP"
	}
	option = {
		name = "HRE_mechanics.410.Bribe_Money"
		trigger = {
			OR = {
				years_of_income = 3
				years_of_income = 2
				years_of_income = 1
			}
		}
		hidden_effect = { country_event = { id = HRE_mechanics.412 } }
		custom_tooltip = "HRE_mechanics.410.CTP_Bribe_Money"
	}
	option = {
		name = "HRE_mechanics.410.Do_Nothing"
		hidden_effect = {
			country_event = {
				id = HRE_mechanics.403
				days = 7
			}
			ERG = { set_key = { lhs = Hft_Infl_Mod value = 0 } } 
		}
	}
}
	
### Bribe event with MP
country_event = {
	id = HRE_mechanics.411
	title = HRE_mechanics.411.t
	desc = HRE_mechanics.411.desc
	is_triggered_only = yes
	picture = HRE_eventPicture
	
	
	option = {
		name = "HRE_mechanics.411.ADM_Focus"
		trigger = { 
			adm_power = 50
			dip_power = 25
			mil_power = 25
		}
		add_adm_power = -50
		add_dip_power = -25
		add_mil_power = -10		
		
		hidden_effect = {
			country_event = {
				id = HRE_mechanics.403 days = 7
			}
			random_list = {
				10 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.300 } } }
				20 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.275 } } }
				40 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.250 } } }
				20 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.225 } } }
				10 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.175 } } }
			}
		}		
	}
	option = {
		name = "HRE_mechanics.411.DIP_Focus"
		trigger = { 
			adm_power = 25 
			dip_power = 50
			mil_power = 25
		}
		
		add_adm_power = -25
		add_dip_power = -50
		add_dip_power = -25
		
		hidden_effect = {
			country_event = {
				id = HRE_mechanics.403 days = 7
			}
			random_list = {
				10 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.175 } } }
				20 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.150 } } }
				40 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.125 } } }
				20 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.100 } } }
				10 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.075 } } }
			}
		}	
	}	
	option = {
		name = "HRE_mechanics.411.MIL_Focus"
		trigger = { 
			adm_power = 25
			dip_power = 25
			mil_power = 50
		}
		
		add_adm_power = -25
		add_dip_power = -25
		add_mil_power = -50
		
		hidden_effect = {
			country_event = {
				id = HRE_mechanics.403 days = 7
			}
			random_list = {
				10 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.100 } } }
				20 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.075 } } }
				40 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.063 } } }
				20 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.045 } } }
				10 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.025 } } }
			}
		}
	}

}

### Bribe Estates with Money event
country_event = {
	id = HRE_mechanics.412
	title = HRE_mechanics.412.t
	desc = HRE_mechanics.412.desc
	is_triggered_only = yes
	picture = HRE_eventPicture
	
	
	option = {
		name = "HRE_mechanics.412.Bribe_Money_Strong"
		trigger = { 
			years_of_income = 3
		}
		add_years_of_income = -3
		hidden_effect = {
			country_event = {
				id = HRE_mechanics.403 days = 7
			}
			random_list = {
				10 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.300 } } }
				20 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.275 } } }
				40 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.250 } } }
				20 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.225 } } }
				10 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.175 } } }
			}
		}
		
	}
	option = {
		name = "HRE_mechanics.412.Bribe_Money_Medium"
		trigger = { years_of_income = 2 }
		add_years_of_income = -2
		hidden_effect = {
			country_event = {
				id = HRE_mechanics.403 days = 7
			}
			random_list = {
				10 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.175 } } }
				20 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.150 } } }
				40 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.125 } } }
				20 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.100 } } }
				10 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.075 } } }
			}
		}	
	}	
	option = {
		name = "HRE_mechanics.412.Bribe_Money_Weak"
		trigger = { years_of_income = 1 }
		add_years_of_income = -1
		hidden_effect = {
			country_event = {
				id = HRE_mechanics.403 days = 7
			}
			random_list = {
				10 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.010 } } }
				20 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.075 } } }
				40 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.063 } } }
				20 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.045 } } }
				10 = { ERG = { change_key = { lhs = Hft_Infl_Mod value = -0.025 } } }
			}
		}
	}
}

#### REACTION TO PROPOSAL WITH INFLUENCE OF EMPEROR
country_event = {
	id = HRE_mechanics.403
	title = HRE_mechanics.403.t
	desc = HRE_mechanics.403.d
	hidden = no
	is_triggered_only = yes
	picture = HRE_eventPicture

	immediate = {
		hidden_effect = {
			ERG = {
				set_key = { lhs = Hft_Sup_Perc value = 0 }
				set_key = { lhs = Hft_Opp_Perc value = 0 }
				set_key = { lhs = Hft_Ref_Perc value = 0 }
				set_key = { lhs = Hft_Infl_Helper which = Hft_Vote_Opp }
				set_key = { lhs = Hft_Infl_Helper2 value = 1 }
				set_key = { lhs = Hft_Ref_Opp value = 0 } #Oppose + Refuse
				
				##### Calculate influence of emperors actions
				### Calc Difference
				subtract_key = { lhs = Hft_Infl_Helper2 which = Hft_Infl_Mod }
				multiply_key = { lhs = Hft_Infl_Helper which = Hft_Infl_Helper2 }
				
				### Add influenced Votes to Support
				change_key = { lhs = Hft_Vote_Sup which = Hft_Infl_Helper }
				
				### Remove Influenced Votes to Oppose
				subtract_key = { lhs = Hft_Vote_Opp which = Hft_Infl_Helper }  
					            
				##ä Calc new percentages
				change_key = { lhs = Hft_Sup_Perc which = Hft_Vote_Sup }
				divide_key = { lhs = Hft_Sup_Perc which = Hft_Votes }
				
				multiply_key = { lhs = Hft_Sup_Perc value = 100 }
				
				change_key = { lhs = Hft_Opp_Perc which = Hft_Vote_Opp }
				divide_key = { lhs = Hft_Opp_Perc which = Hft_Votes }
				
				multiply_key = { lhs = Hft_Opp_Perc value = 100 }
	            
				change_key = { lhs = Hft_Ref_Perc which = Hft_Vote_Ref }
				divide_key = { lhs = Hft_Ref_Perc which = Hft_Votes }
				
				multiply_key = { lhs = Hft_Ref_Perc value = 100 }
				
				change_key = { lhs = Hft_Ref_Opp which = Hft_Opp_Perc }
				change_key = { lhs = Hft_Ref_Opp which = Hft_Ref_Perc }
			}
		}
	}
	
	after = {
		### Clear helper variables
		hidden_effect = {
			set_key = { lhs = Hft_Infl_Helper value = 0 }
			set_key = { lhs = Hft_Infl_Helper2 value = 0 }
		}
	}

		
	####################
	## Hoftag Agendas ##
	####################
	
	option = {
		name =  "HRE_mechanics.403.Hoftag_Agenda_Success" 
		### TODO Customizable localization
		trigger = {			
			ERG = { check_key = { lhs = Hft_Sup_Perc value = 51 } }
			hoftag_agenda_trigger = yes
		}
		hidden_effect = {
			
			### Clear/Set flags according to outcome
			Hft_Agenda_success = yes
			
			### Start next phase
			Hft_reverse_bribing_boni = yes
			Hft_change_phase = yes
			
			every_country = {
				limit = {
					has_country_flag = Hft_Invited
				}
				country_event = { id = HRE_mechanics.405 days = 21 }
			}
		}
	}	
	
	option = {
		name = " "
		### Start next phase
		Hft_reverse_bribing_boni = yes
		Hft_change_phase = yes		
	}
}




### The Hoftag Ends
country_event = {
	id = HRE_mechanics.404
	title = HRE_mechanics.404.t
	desc = HRE_mechanics.404.d
	hidden = yes
	is_triggered_only = yes
	
	immediate = {
		hidden_effect = {
			Hft_Agend_Suc_Execution = yes
			
			every_country = {
				limit = {
					is_part_of_hre = yes
				}
				
				### TODO
				country_event = { id = HRE_mechanics.405 } ### HRE Herald - Infos for everone about the outcome
			}
		
		}
	}
	
	option = {
	
	}
}

### Imperial Demands - princes get request to pay
country_event = {
	id = HRE_mechanics.406
	title = HRE_mechanics.406.t
	desc = HRE_mechanics.406.d
	is_triggered_only = yes

	
	immediate = {
		hidden_effect = {
			export_to_variable = {
				which = their_money_contr
				value = years_of_income
				who = ROOT
			}
			export_to_variable = {
				which = their_manpower_contr
				value = max_manpower
				who = ROOT
			}
		
			## Set in scripted effect
			multiply_key = { lhs = their_money_contr which = imp_dem_duc }
			## Set in scripted effect
			multiply_key = { lhs = their_manpower_contr which = imp_dem_man }
			
			##
			set_key = { lhs = their_cen_contr which = imp_dem_cen }
			
			emperor = {
				change_key = { lhs = their_money_contr which = ROOT }
				change_key = { lhs = their_manpower_contr which = ROOT }
				change_key = { lhs = their_cen_contr which = ROOT }
			}
		}
	}
	
	option = {
		name = "HRE_mechanics.406.approve"
		trigger = {
			## TODO
		}
		ai_chance = {
			## TODO
			factor = 100
		}

		scaled_GameCurrency_change = { type = treasury variable = their_money_contr }
		scaled_GameCurrency_change = { type = manpower variable = their_manpower_contr }
		standard_GameCurrency_Change = { function = increase size = small type = prestige }
	}
	option = {
		name = "HRE_mechanics.406.decline"
		trigger = {
			## TODO
		}
		ai_chance = {
			## TODO
			factor = 0
		}
		add_opinion = { who = emperor modifier = Ignored_Hft_Decision }
	}
}

### Imperial Demands - Emperor gains result
country_event = {
	id = HRE_mechanics.407
	title = HRE_mechanics.407.t
	desc = HRE_mechanics.407.d
	is_triggered_only = yes
	picture = HRE_eventPicture
	
	immediate = {
	}
	
	after = {
		hidden_effect = {
			HRE_Hoftag_Cleanup = yes
		}
	}
	
	option = {
		name = "HRE_mechanics.407.a"
		
		if = {
			limit = {
				NOT = {
					OR = {
						has_country_flag = Hft_Agen_Romzug_Suc
						has_country_flag = Hft_Agen_Defense_Suc
						has_country_flag = Hft_Agen_Romzug_1
						has_country_flag = Hft_Agen_Defense_1
					}
				}
			}
			scaled_GameCurrency_change = { type = treasury variable = their_money_contr }
			scaled_GameCurrency_change = {  type = manpower variable = their_money_contr }
			change_imperial_centralization = { variable = their_cen_contr }
		}
	}
}

### Setup Reichstag test event
country_event = {
	id = HRE_mechanics.500
	title = HRE_mechanics.500.t
	desc = HRE_mechanics.500.d
	picture = HRE_eventPicture
	
	hidden = no
	
	is_triggered_only = yes
	
	
	immediate = {
		hidden_effect = {
			every_country = {
				limit = {
					OR = {
						has_country_flag = imperial_elector
						has_country_flag = imperial_prince
						has_country_flag = imperial_bishopric
					}
					NOT = { capital_scope = { superregion = italy_superregion } } 
				}
				set_country_flag = Rht_FV
			}
			every_country = {
				limit = {
					OR = {
						has_country_flag = imperial_city
						has_country_flag = imperial_count
					}
					NOT = { capital_scope = { superregion = italy_superregion } } 
				}
				set_country_flag = Rht_KV	
			}
			set_global_flag = HRE_INST_RT_A
			set_key = { lhs = HRE_ADM_RefDes value = 0 }
		}
	}
		
	option = {
		name = "HRE_mechanics.500.a"

		ai_chance = {
			factor = 0
		}
		highlight = yes
	}
}




####Reichstag
country_event = {
	id = HRE_mechanics.600
	title = HRE_mechanics.600.t
	desc = HRE_mechanics.600.desc
	picture = HRE_eventPicture

	hidden = no
	
	is_triggered_only = yes
	
	trigger = {
		has_global_flag = HRE_INST_RT_A ### Reichstag Reform 
	}

	### choose the place
	option = {
		name = HRE_mechanics.600.Chose_place
		trigger = {
			is_emperor = yes
			NOT = { has_country_flag = Rht_Place_Setup }
		}
		
		country_event = { id = HRE_mechanics.601 }
	}

	### choose the Agenda
	option = {
		name = HRE_mechanics.600.Chose_agenda
		trigger = {
			is_emperor = yes
			NOT = { has_country_flag = Rht_Agen_Setup }
		}
		
		country_event = { id = HRE_mechanics.602 }
	}

	option = {
		name = HRE_mechanics.600.ask_for_agenda_points
		trigger = {
			is_emperor = no
		}
	}

	option = {
		name = HRE_mechanics.600.estates
		trigger = {
			is_emperor = no
		}
	}

	#Starts Reichstag
	option = {
		name = HRE_mechanics.600.start
			
		highlight = yes
		
		trigger = { 
			has_country_flag = Rht_Place_Setup
			has_country_flag = Rht_Agen_Setup
		}
		
		Reichstag_Invitation = yes
		hidden_effect = { country_event = { id = HRE_mechanics.6032 days = 100 } }
	}
}


### Choose place for the Reichstag
country_event = {
	id = HRE_mechanics.601
	title = HRE_mechanics.601.t
	desc = HRE_mechanics.601.d
	hidden = no
	picture = HRE_eventPicture

	
	is_triggered_only = yes


	option = {
		name = "HRE_mechanics.601.choose_aachen"
		trigger = {
			4009 = {
				owner = {
					tag = AAC
					has_country_flag = imperial_city
				}
			}		
		}
		
		### Meta Script - See Reichstag scripted effects file
		Reichstag_Site_Chosing = { where = Aachen }

		country_event = { id = HRE_mechanics.600 }
	}
	
	option = {
		name = "HRE_mechanics.601.choose_frankfurt"
		trigger = {
			1365 = {
				owner = { 
					tag = FRF
					has_country_flag = imperial_city
				}
			}	
		}

		### Meta Script - See Reichstag scripted effects file
		Reichstag_Site_Chosing = { where = Frankfurt }
		
		country_event = { id = HRE_mechanics.600 }
	}
	
	option = {
		name = "HRE_mechanics.601.choose_nuernberg"
		trigger = {
			81 = {
				owner = { 
					tag = NUR
					has_country_flag = imperial_city
				}
			}		
		}
		
		### Meta Script - See Reichstag scripted effects file
		Reichstag_Site_Chosing = { where = Nuernberg }
		
		country_event = { id = HRE_mechanics.600 }
	}
	option = {
		name = "HRE_mechanics.601.choose_random"
		trigger = {
			calc_true_if = {
				any_country = {
					has_country_flag = imperial_city
					is_part_of_hre = yes
				}
				amount = 1
			}
		}
		
		### Meta Script - See hre_mechanics scripted effects file
		Reichstag_Site_Chosing = { where = Random }
		
		country_event = { id = HRE_mechanics.600 } ## Back to Menu
	}
}

###### Agenda for Reichstag
country_event = {
	id = HRE_mechanics.602
	title = HRE_mechanics.602.t
	desc = HRE_mechanics.602.d
	picture = HRE_eventPicture

	hidden = no
	
	is_triggered_only = yes
	
	immediate = {
	}

	### Imperial Tribute --> Money for the Emperor - based on amount of members
	option = {
		name = "HRE_mechanics.602.imperial_tribute"
		trigger = {
			### Meta Trigger - See hre_mechanics scripted trigger file
			Reichstag_Add_Agenda_Topic_Trigger = { topic = Trib }
		}
		### Meta Script - See hre_mechanics scripted effects file
		Reichstag_Add_Agenda_Topic = { topic = Trib }
		
		country_event = { id = HRE_mechanics.6021 }		
	}

	### Imperial Conscription --> Manpower + Forcelimit - based on amount of members
	option = {
		name = "HRE_mechanics.602.Imperial_Conscription"
		trigger = {
			### Meta Trigger - See hre_mechanics scripted trigger file
			Reichstag_Add_Agenda_Topic_Trigger = { topic = Consc }
		}
		### Meta Script - See hre_mechanics scripted effects file
		Reichstag_Add_Agenda_Topic = { topic = Consc }
		
		country_event = { id = HRE_mechanics.6021 }	##Mirror event
	}

	### Imperial Centralize --> increase IA, decrease opinion with empire, increase imperial adm reform desire
	option = {
		name = "HRE_mechanics.602.Imperial_Centralization"
		trigger = {
			### Meta Trigger - See hre_mechanics scripted trigger file
			Reichstag_Add_Agenda_Topic_Trigger = { topic = Centr }
		}
		### Meta Script - See hre_mechanics scripted effects file
		Reichstag_Add_Agenda_Topic = { topic = Centr }
		
		country_event = { id = HRE_mechanics.6021 }	##Mirror event
		
	}
	
	option = {
		name = "HRE_mechanics.602.agenda_finished"
		highlight = yes
		trigger = {	ERG = { check_key = { lhs = Rht_Agen value = 1 } } }
		set_country_flag = Rht_Agen_Setup
		
		country_event = { id = HRE_mechanics.600 }
	}
	
	
	option = {
		name = back
		country_event = { id = HRE_mechanics.600 }
	}
	
}

###### Agenda for Reichstag 
country_event = {
	id = HRE_mechanics.6021
	title = HRE_mechanics.6021.t
	desc = HRE_mechanics.6021.d
	picture = HRE_eventPicture

	hidden = no
	
	is_triggered_only = yes
	
	immediate = {
	
	}
	
	### Imperial Tribute --> Money for the Emperor - based on amount of members
	option = {
		name = "HRE_mechanics.6021.imperial_tribute"
		trigger = {
			### Meta Trigger - See hre_mechanics scripted trigger file
			Reichstag_Add_Agenda_Topic_Trigger = { topic = Trib }
		}
		### Meta Script - See hre_mechanics scripted effects file
		Reichstag_Add_Agenda_Topic = { topic = Trib }
		
		country_event = { id = HRE_mechanics.602 }		
	}

	### Imperial Conscription --> Manpower + Forcelimit - based on amount of members
	option = {
		name = "HRE_mechanics.6021.Imperial_Conscription"
		trigger = {
			### Meta Trigger - See hre_mechanics scripted trigger file
			Reichstag_Add_Agenda_Topic_Trigger = { topic = Consc }
		}
		### Meta Script - See hre_mechanics scripted effects file
		Reichstag_Add_Agenda_Topic = { topic = Consc }
		
		country_event = { id = HRE_mechanics.602 }	##Mirror event
	}

	### Imperial Centralize --> increase IA, decrease opinion with empire, increase imperial adm reform desire
	option = {
		name = "HRE_mechanics.6021.Imperial_Centralization"
		trigger = {
			### Meta Trigger - See hre_mechanics scripted trigger file
			Reichstag_Add_Agenda_Topic_Trigger = { topic = Centr }
		}
		### Meta Script - See hre_mechanics scripted effects file
		Reichstag_Add_Agenda_Topic = { topic = Centr }
		
		country_event = { id = HRE_mechanics.602 }	##Mirror event
		
	}
	
	option = {
		name = "HRE_mechanics.6021.agenda_finished"
		highlight = yes
		trigger = {	ERG = { check_key = { lhs = Rht_Agen value = 1 } } }
		set_country_flag = Rht_Agen_Setup
		
		country_event = { id = HRE_mechanics.600 }
	}
	
	
	option = {
		name = back
		country_event = { id = HRE_mechanics.600 }
	}	
}

###### Reichstag invitation members
country_event = {
	id = HRE_mechanics.6031
	title = HRE_mechanics.6031.t
	desc = HRE_mechanics.6031.d
	picture = HRE_eventPicture

	hidden = no
	
	is_triggered_only = yes
	
	immediate = {
	}
	
	# PARTICIPATE
	option = {
		name = "HRE_mechanics.6031.a"
		ai_chance = {
			factor = 100
			### TODO
		}		
		set_country_flag = Rht_PART_MEMBER
	}
	
	# DO NOT PARTICIPATE
	option = {
		name = "HRE_mechanics.6031.b"
		
		ai_chance = {
			factor = 0
			### TODO
		}
		
		set_country_flag = Rht_MISS_MEMBER
		
	}
}	

###### Reichstag starting evaluation
country_event = {
	id = HRE_mechanics.6032
	title = HRE_mechanics.6032.t
	desc = HRE_mechanics.6032.d
	picture = HRE_eventPicture

	hidden = yes
	
	is_triggered_only = yes
	
	immediate = {
		## Calculate general Reichstag variables
		
		# total votes with abstaining princes
		every_country = {
			limit = { OR = { has_country_flag = Rht_FV has_country_flag = Rht_KV } }
			if = { limit = { has_country_flag = Rht_FV } ERG = { change_key = { lhs = Rht_TV_w_missing value = 1 } } }
			else_if = { limit = { has_country_flag = Rht_KV } ERG = { change_key = { lhs = Rht_TV_w_missing value = 0.1 } } }
		}
		
		# Missing votes
		every_country = {
			limit = { has_country_flag = Rht_MISS_MEMBER }
			if = { limit = { has_country_flag = Rht_FV } ERG = { change_key = { lhs = Rht_V_missing value = 1 } } }
			else_if = { limit = { has_country_flag = Rht_KV } ERG = { change_key = { lhs = Rht_V_missing value = 0.1 } } }					
		}
		
		# %missing of total
		ERG = {
			divide_key = { lhs = Rht_V_missing which = Rht_TV_w_missing } 
			if = { limit = { check_key = { lhs = Rht_V_missing value = 0.5 } }
				every_country = { limit = { OR = { is_emperor = yes has_country_flag = Rht_PART_MEMBER has_country_flag = Rht_MISS_MEMBER } }
					### Imperial Diet is canceled
					country_event = { id = HRE_mechanics.6033 }
				}
			}
			else = {
				every_country = { limit = { OR = { is_emperor = yes has_country_flag = Rht_PART_MEMBER } }
					### Imperial Diet is starting
					country_event = { id = HRE_mechanics.6034 }
				}
				emperor = { country_event = { id = HRE_mechanics.604 days = 3 } }
				ERG = { set_country_flag = Rht_Phase_1 }
			}
		}
		### TODO Safety variable Cleanup
	}
	
	option = {
		name = "HRE_mechanics.6032.a"
		
		
	}
}	

###### Reichstag is missing to many members

### POSSIBLE TODO - MINORITY IMPERIAL DIET with religious conflicts
country_event = {
	id = HRE_mechanics.6033
	title = HRE_mechanics.6033.t
	desc = HRE_mechanics.6033.d
	picture = HRE_eventPicture

	hidden = no
	
	is_triggered_only = yes
	
	after = { 
		HRE_Reichstag_Cleanup = yes
	}
	
	option = {
		name = "HRE_mechanics.6033.a"
		trigger = { is_emperor = yes }
	}
	
	option = {
		name = "HRE_mechanics.6033.b"
		trigger = { has_country_flag = Rht_PART_MEMBER }
		clr_country_flag = Rht_PART_MEMBER
	}
	
	option = {
		name = "HRE_mechanics.6033.c"
		trigger = { has_country_flag = Rht_MISS_MEMBER }
		clr_country_flag = Rht_MISS_MEMBER
	}
}

###### Reichstag Starting Notification
country_event = {
	id = HRE_mechanics.6034
	title = HRE_mechanics.6034.t
	desc = HRE_mechanics.6034.d
	picture = HRE_eventPicture
	
	hidden = no
	
	is_triggered_only = yes
	
	immediate = { 
	}
	
	option = {
		name = "HRE_mechanics.6034.a"	
		
	}
	
}

###### Reichstag Phase Event - Start of Discussions
country_event = {
	id = HRE_mechanics.604
	title = HRE_mechanics.604.t
	desc = HRE_mechanics.604.desc
	picture = HRE_eventPicture

	hidden = no
	
	is_triggered_only = yes
	
	immediate = {
		#Start Estate Discussion
		hidden_effect = {
			#Reset variables
			Rht_Change_Phase_Clean_Variables = yes
			
			# Curial Chamber
			every_country = {
				limit = { has_country_flag = imperial_elector }
				country_event = { id = HRE_mechanics.610 days = 2 }
				if = {
					limit = { has_country_flag = Rht_FV }
					ERG = { change_key = { lhs = Rht_AgenPoint_TV_CUR value = 1 } }
				}
				else_if = {
					limit = { has_country_flag = Rht_KV }
					ERG = { change_key = { lhs = Rht_AgenPoint_TV_CUR value = 0.1 } }					
				}
			}
			# Princly Chamber
			every_country = {
				limit = { 
					OR = {
						has_country_flag = imperial_prince
						has_country_flag = imperial_bishopric
						has_country_flag = imperial_count
					}
				}
				country_event = { id = HRE_mechanics.611 days = 2 }
				if = {
					limit = { has_country_flag = Rht_FV }
					ERG = { change_key = { lhs = Rht_AgenPoint_TV_PRI value = 1 } }
				}
				else_if = {
					limit = { has_country_flag = Rht_KV }
					ERG = { change_key = { lhs = Rht_AgenPoint_TV_PRI value = 0.1 } }					
				}
			}
			# Cities Chamber
			every_country = {
				limit = { OR = { has_country_flag = imperial_city has_country_flag = imperial_free_city } }
				country_event = { id = HRE_mechanics.612 days = 2 }
				if = {
					limit = { has_country_flag = Rht_FV }
					ERG = { change_key = { lhs = Rht_AgenPoint_TV_CIT value = 1 } }
				}
				else_if = {
					limit = { has_country_flag = Rht_KV }
					ERG = { change_key = { lhs = Rht_AgenPoint_TV_CIT value = 0.1 } }					
				}
			}
			emperor = { country_event = { id = HRE_mechanics.605 days = 14 } }
		}
	}
	
	### Start Discussions
	option = {
		name = "HRE_mechanics.604.a"
		
	}
	
	## Bribe Curia
	option = {
		name = "HRE_mechanics.604.b"
		#Meta Script See HRE - Reichstag_Effects
		Rht_INFL_Chamber_Cost = { chamber = CUR }
		Rht_INFL_Chamber_Total= { chamber = CUR type = APPR }			
	}
	
	## Bribe Princes
	option = {
		name = "HRE_mechanics.604.c"
		#Meta Script See HRE - Reichstag_Effects
		Rht_INFL_Chamber_Cost = { chamber = PRI }
		Rht_INFL_Chamber_Total= { chamber = PRI type = APPR }			
	}
	
	## Bribe Cities
	option = {
		name = "HRE_mechanics.604.d"
		#Meta Script See HRE - Reichstag_Effects
		Rht_INFL_Chamber_Cost = { chamber = CIT }
		Rht_INFL_Chamber_Total= { chamber = CIT type = APPR }			
	}
	
	##	Bribe All
	option = {
		name = "HRE_mechanics.604.e"
		#Meta Script See HRE - Reichstag_Effects
		Rht_INFL_Chamber_Cost = { chamber = CUR }
		Rht_INFL_Chamber_Total= { chamber = CUR type = APPR }			
		#Meta Script See HRE - Reichstag_Effects
		Rht_INFL_Chamber_Cost = { chamber = PRI }
		Rht_INFL_Chamber_Total= { chamber = PRI type = APPR }			
		#Meta Script See HRE - Reichstag_Effects
		Rht_INFL_Chamber_Cost = { chamber = CIT }
		Rht_INFL_Chamber_Total= { chamber = CIT type = APPR }			
	}
}

###### Reichstag Phase Event - Emperor Decision
country_event = {
	id = HRE_mechanics.605
	title = HRE_mechanics.605.t
	desc = HRE_mechanics.605.d
	picture = HRE_eventPicture

	hidden = no
	
	is_triggered_only = yes
	
	immediate = {
		Rht_Phase_Chamber_Evaluation = { chamber = CUR }
		Rht_Phase_Chamber_Evaluation = { chamber = PRI }
		Rht_Phase_Chamber_Evaluation = { chamber = CIT }
	}
	
	### Emperor approves
	option = {
		name = "HRE_mechanics.605.a"
		trigger = { Rht_Chamber_APPROVEMENT_trigger = yes }
		
		### TODO - Evaluation of passing reform for estates - e.g. displeased imperial estates - Scaling and situational
		ERG = { set_country_flag = Rht_AgenPoint_EMP_APPROVED }
	}
	
	### Emperor rejects, while estates approve
	option = {
		name = "HRE_mechanics.605.b"
		
		trigger = { Rht_Chamber_APPROVEMENT_trigger = yes }
		### TODO - Evaluation of passing reform for estates - e.g. displeased imperial estates - Scaling and situational
		add_estate_loyalty = { estate = imperial_estates loyalty = -10 }
		
	}

	### Emperor rejects, estates also reject
	option = {
		name = "HRE_mechanics.605.c"
		
		trigger = { NOT = { Rht_Chamber_APPROVEMENT_trigger = yes } }
		### TODO - Evaluation of passing reform for estates - e.g. displeased imperial estates - Scaling and situational
			
		### TODO - Restart disucssion - bribing etc, different proposals etc.
		
	}

	after = {
		hidden_effect = {
			Rht_Phase_Cross_Chamber_Evaluation = yes
			if = { limit = { ERG = { has_country_flag = Rht_AgenPoint_APPROVED } }
				Rht_Agenda_success = yes
				
			}
			else = {
				Rht_Agenda_Failure = yes
			}
			Rht_change_phase = yes
		}
	}
}

###### Reichstag Phase Event - Conclusion of Reichstag - Emperor
country_event = {
	id = HRE_mechanics.606
	title = HRE_mechanics.606.t
	desc = HRE_mechanics.606.desc
	picture = HRE_eventPicture

	hidden = no
	
	is_triggered_only = yes
	
	immediate = {

	}
	
	option = {
		name = "HRE_mechanics.606.a"
		hidden_effect = {
			Rht_Agend_Suc_Execution = yes
		}			
	}
}

###### Reichstag Phase Event - Conclusion of Reichstag - HRE Members
country_event = {
	id = HRE_mechanics.607
	title = HRE_mechanics.607.t
	desc = HRE_mechanics.607.desc
	picture = HRE_eventPicture

	hidden = no
	
	is_triggered_only = yes
	
	immediate = {
	
	}
	
	option = {
		name = "HRE_mechanics.607.a"
	}
}	

### Imperial Demands - princes get request to pay
country_event = {
	id = HRE_mechanics.608
	title = HRE_mechanics.608.t
	desc = HRE_mechanics.608.d
	is_triggered_only = yes

	
	immediate = {
		hidden_effect = {
			export_to_key = {
				which = their_money_contr
				value = years_of_income
			}
			export_to_key = {
				which = their_manpower_contr
				value = max_manpower
			}
		
			## Set in scripted effect
			multiply_key = { lhs = their_money_contr which = imp_dem_duc }
			## Set in scripted effect
			multiply_key = { lhs = their_manpower_contr which = imp_dem_man }
			
			##
			set_key = { lhs = their_cen_contr which = imp_dem_cen }
			
			emperor = {
				change_key = { lhs = their_money_contr which = ROOT }
				change_key = { lhs = their_manpower_contr which = ROOT }
				change_key = { lhs = their_cen_contr which = ROOT }
			}
		}
	}
	
	option = {
		name = "HRE_mechanics.608.approve"
		trigger = {
			## TODO
		}
		ai_chance = {
			## TODO
			factor = 100
		}

		scaled_GameCurrency_change = { type = treasury variable = their_money_contr }
		scaled_GameCurrency_change = { type = manpower variable = their_manpower_contr }
		standard_GameCurrency_Change = { function = increase size = small type = prestige }
	}
	option = {
		name = "HRE_mechanics.608.decline"
		trigger = {
			## TODO
		}
		ai_chance = {
			## TODO
			factor = 0
		}
		add_opinion = { who = emperor modifier = Ignored_Rht_Decision }
	}
}

### Imperial Demands - Emperor gains result
country_event = {
	id = HRE_mechanics.609
	title = HRE_mechanics.609.t
	desc = HRE_mechanics.609.d
	is_triggered_only = yes
	picture = HRE_eventPicture
	
	immediate = {
	}
	
	after = {
		hidden_effect = {
			HRE_Reichstag_Cleanup = yes
		}
	}
	
	option = {
		name = "HRE_mechanics.609.a"
		
		scaled_GameCurrency_change = { type = treasury variable = their_money_contr }
		scaled_GameCurrency_change = { type = manpower variable = their_money_contr }
		change_imperial_centralization = { variable = their_cen_contr }		
	}
}


###### Reichstag Curial Chamber - Member Decisionmaking
country_event = {
	id = HRE_mechanics.610
	title = HRE_mechanics.610.t
	desc =  HRE_mechanics.610.desc
	picture = HRE_eventPicture
	
	hidden = no 
	is_triggered_only = yes

	immediate = {
		custom_tooltip = HRE_mechanics.CTP_YourVotes	
		custom_tooltip = HRE_mechanics.Rht.VoteInfluencing	
	}

	## Approve Agenda point
	option = {
		name = "HRE_mechanics.610.a"
		
		ai_chance = {
			factor = 60
			#TODO AI
		}	
		
		#Meta Script See HRE - Reichstag_Effects
		Rht_Add_Votes_APPR = { chamber = CUR }
	}

	## Reject Agenda point	
	option = {
		name = "HRE_mechanics.610.b"
		
		ai_chance = {
			factor = 40
			#TODO AI			
		}
		
		#Meta Script See HRE - Reichstag_Effects
		Rht_Add_Votes_REJC = { chamber = CUR }
	}
	
	## Try to influence the chambers discussion - Approval
	option = {
		name = "HRE_mechanics.610.c"
		
		trigger = { OR = { DIP = 4 DIP = 5 DIP = 6 AND = { DIP = 3 OR = { ADM = 4 ADM = 5 ADM = 6 MIL = 4 MIL = 5 MIL = 6 } } } }
		
		ai_chance = {
			factor = 0
			#TODO AI
		}
		
		#Meta Script See HRE - Reichstag_Effects
		Rht_Add_Votes_APPR = { chamber = CUR }	
		Rht_INFL_Chamber_Cost = { chamber = CUR }
		Rht_INFL_Chamber_Total = { chamber = CUR type = APPR }			
	}
	
	## Try to influence the chambers discussion - Reject
	option = {
		name = "HRE_mechanics.610.d"

		trigger = { OR = { DIP = 4 DIP = 5 DIP = 6 AND = { DIP = 3 OR = { ADM = 4 ADM = 5 ADM = 6 MIL = 4 MIL = 5 MIL = 6 } } } }
		
		ai_chance = {
			factor = 0
			#TODO AI
		}
		
		#Meta Script See HRE - Reichstag_Effects
		Rht_Add_Votes_REJC = { chamber = CUR }	
		Rht_INFL_Chamber_Cost = { chamber = CUR }
		Rht_INFL_Chamber_Total = { chamber = CUR type = REJC }	
	}	
}


###### Reichstag Princly Chamber - Member Decisionmaking
country_event = {
	id = HRE_mechanics.611
	title = HRE_mechanics.611.t
	desc =  HRE_mechanics.611.desc
	picture = HRE_eventPicture
	
	hidden = no 
	is_triggered_only = yes

	immediate = {
		custom_tooltip = HRE_mechanics.CTP_YourVotes	
		custom_tooltip = HRE_mechanics.Rht.VoteInfluencing	
	}

	## Approve Agenda point
	option = {
		name = "HRE_mechanics.611.a"
		
		ai_chance = {
			factor = 60
			#TODO AI
		}
		
		#Meta Script See HRE - Reichstag_Effects
		Rht_Add_Votes_APPR = { chamber = PRI }
	}

	## Reject Agenda point	
	option = {
		name = "HRE_mechanics.611.b"
		
		ai_chance = {
			factor = 40
			#TODO AI			
		}
		
		#Meta Script See HRE - Reichstag_Effects
		Rht_Add_Votes_REJC = { chamber = PRI }
	}
	
	## Try to influence the chambers discussion - Approval
	option = {
		name = "HRE_mechanics.611.c"
		
		trigger = { OR = { DIP = 4 DIP = 5 DIP = 6 AND = { DIP = 3 OR = { ADM = 4 ADM = 5 ADM = 6 MIL = 4 MIL = 5 MIL = 6 } } } }
		
		ai_chance = {
			factor = 0
			#TODO AI
		}
		
		#Meta Script See HRE - Reichstag_Effects
		Rht_Add_Votes_APPR = { chamber = PRI }	
		Rht_INFL_Chamber_Cost = { chamber = PRI }
		Rht_INFL_Chamber_Total = { chamber = PRI type = APPR }	
				
	}
	
	## Try to influence the chambers discussion - Reject
	option = {
		name = "HRE_mechanics.611.d"

		trigger = { OR = { DIP = 4 DIP = 5 DIP = 6 AND = { DIP = 3 OR = { ADM = 4 ADM = 5 ADM = 6 MIL = 4 MIL = 5 MIL = 6 } } } }
		
		ai_chance = {
			factor = 0
			#TODO AI
		}
		
		#Meta Script See HRE - Reichstag_Effects
		Rht_Add_Votes_REJC = { chamber = PRI }	
		Rht_INFL_Chamber_Cost = { chamber = PRI }
		Rht_INFL_Chamber_Total = { chamber = PRI type = REJC }	

	}	
}



###### Reichstag Cities Chamber - Member Decisionmaking
country_event = {
	id = HRE_mechanics.612
	title = HRE_mechanics.612.t
	desc =  HRE_mechanics.612.desc
	picture = HRE_eventPicture

	hidden = no 
	is_triggered_only = yes

	immediate = {
		custom_tooltip = HRE_mechanics.CTP_YourVotes	
		custom_tooltip = HRE_mechanics.Rht.VoteInfluencing
	}

	## Approve Agenda point
	option = {
		name = "HRE_mechanics.612.a"
		
		ai_chance = {
			factor = 60
			#TODO AI
		}
		
		#Meta Script See HRE - Reichstag_Effects
		Rht_Add_Votes_APPR = { chamber = CIT }
	}

	## Reject Agenda point	
	option = {
		name = "HRE_mechanics.612.b"
		
		ai_chance = {
			factor = 40
			#TODO AI			
		}
	
		#Meta Script See HRE - Reichstag_Effects
		Rht_Add_Votes_REJC = { chamber = CIT }
	}
	
	## Try to influence the chambers discussion - Approval
	option = {
		name = "HRE_mechanics.612.c"
		
		trigger = { OR = { DIP = 4 DIP = 5 DIP = 6 AND = { DIP = 3 OR = { ADM = 4 ADM = 5 ADM = 6 MIL = 4 MIL = 5 MIL = 6 } } } }
		
		ai_chance = {
			factor = 0
			#TODO AI
		}
		
		#Meta Script See HRE - Reichstag_Effects
		Rht_Add_Votes_APPR = { chamber = CIT }	
		Rht_INFL_Chamber_Cost = { chamber = CIT }
		Rht_INFL_Chamber_Total = { chamber = CIT type = APPR }					
	}
	
	## Try to influence the chambers discussion - Reject
	option = {
		name = "HRE_mechanics.612.d"

		trigger = { OR = { DIP = 4 DIP = 5 DIP = 6 AND = { DIP = 3 OR = { ADM = 4 ADM = 5 ADM = 6 MIL = 4 MIL = 5 MIL = 6 } } } }
		
		ai_chance = {
			factor = 0
			#TODO AI
		}
		
		#Meta Script See HRE - Reichstag_Effects
		Rht_Add_Votes_REJC = { chamber = CIT }	
		Rht_INFL_Chamber_Cost = { chamber = CIT }
		Rht_INFL_Chamber_Total = { chamber = CIT type = REJC }					

	}	
}


####Kurfürstenkollegium
country_event = {
	id = HRE_mechanics.700
	title = HRE_mechanics.700.t
	desc = HRE_mechanics.700.d
	picture = HRE_eventPicture

	hidden = no
	
	is_triggered_only = yes

	option = {
	
	}



}



####Städterat
country_event = {
	id = HRE_mechanics.800
	title = HRE_mechanics.800.t
	desc = HRE_mechanics.800.d
	picture = HRE_eventPicture

	hidden = no
	
	is_triggered_only = yes

	option = {
	
	}


}













#####################################
### 002 Estate Interaction Events ###
#####################################

### Strengthen rule menu
#country_event = {
#	id = HRE_mechanics.1000
#	title = HRE_mechanics.1000.t
#	desc = HRE_mechanics.1000.d
#	picture = HRE_eventPicture
#	
#	hidden = no
#	
#	is_triggered_only = yes
#	
#	option = {
#		name = "HRE_mechanics.1000.Use_Adm_Power"
#		
#		trigger = {		
#				emperor = {
#					AND = {
#						ADM = 4
#						adm_power = 25
#					}
#				}	
#		}
#	
#		ai_chance = {
#			factor = 50	
#		}
#		
#		add_adm_power = -25
#		add_imperial_influence = 2.5
#		
#				emperor = {
#			### Boni
#			add_estate_loyalty = {
#				estate = imperial_estates
#				loyalty = 5
#			}
#				
#			### Mali
#			add_country_modifier = {
#				name = emperor_strengthen_rule_adm
#				duration = 1825
#			}
#			hidden_effect = {
#				add_country_modifier = {
#					name = emperor_strengthen_rule_cd
#					duration = 3650		
#				}
#			}
#		}
#
#	}
#	option = {
#		name = "HRE_mechanics.1000.Use_Dip_Power"
#	
#		trigger = {
#			emperor = {
#				AND = {
#					DIP = 4
#					dip_power = 25
#				}
#			}			
#					
#		}
#		
#		ai_chance = {
#			factor = 50	
#		}
#		add_dip_power = -25
#		add_imperial_influence = 2.5
#			
#		emperor = {
#			### boni
#			add_estate_loyalty = {
#				estate = imperial_estates
#				loyalty = 5
#			}
#			
#			### Penalties
#			add_country_modifier = {
#				name = emperor_strengthen_rule_dip
#				duration = 1825
#			}
#			hidden_effect = {
#				add_country_modifier = {
#					name = emperor_strengthen_rule_cd
#					duration = 	3650		
#				}
#			}
#		}
#	}
#	option = {
#		name = "HRE_mechanics.1000.Use_Mil_Power"
#	
#		trigger = {
#			emperor = {
#				AND = {
#					MIL = 4
#					mil_power = 25
#				}
#			}
#		}
#		ai_chance = {
#			factor = 50	
#		}
#		
#		add_mil_power = -25
#		
#		add_imperial_influence = 2.5
#
#		emperor = {
#			### BONI
#			add_estate_loyalty = {
#				estate = imperial_estates
#				loyalty = 5
#			}
#			
#			### Penalties
#			add_country_modifier = {
#				name = emperor_strengthen_rule_mil
#				duration = 1825
#			}
#			hidden_effect = {
#				add_country_modifier = {
#					name = emperor_strengthen_rule_cd
#					duration = 	3650		
#				}
#			}
#		}
#		
#	
#	}	
#
#}


### Request money to confirm old privileges - counts, free cities, ...?
country_event = {
	id = HRE_mechanics.1001
	title = HRE_mechanics.1001.t
	desc = HRE_mechanics.1001.d
	picture = HRE_eventPicture
	
	hidden = no
	
	is_triggered_only = yes
	
	
	trigger = {
		is_emperor = yes
		#NOT = { has_country_flag =  }
	}
	
	
	### Request money from cities to confirm their privileges
	option = {
		name = "HRE_mechanics.1001.cities"
		
		custom_tooltip = "HRE_mechanics.1001.cities.ctp"
		
		hidden_effect = {
			set_country_flag = emperor_awaits_response_privileges_city
			
			every_country = {
				limit = {
					has_country_flag = imperial_free_city
					NOT = { has_country_flag = imperial_immediacy }
				}
				set_country_flag = target_for_confirming_privileges
				country_event = { id = HRE_mechanics.1002 days = 15 }
				emperor = { change_key = { lhs = numb_targets_privileges value = 1 } }
			}
			country_event = { id = HRE_mechanics.1003 days = 60 }	
			add_ruler_modifier = { name = emperor_privileges_cd_cities }
		}		
	}

	### Request money from free counts to confirm their privileges
	option = {
		name = "HRE_mechanics.1001.counts"
		custom_tooltip = "HRE_mechanics.1001.counts.ctp"		
		
		hidden_effect = {
		
			set_country_flag = emperor_awaits_response_privileges_city		
			
			every_country = {
				limit = {
					has_country_flag = imperial_count
					NOT = { has_country_flag = imperial_immediacy }
				}
				set_country_flag = target_for_confirming_privileges
				country_event = { id = HRE_mechanics.1002 days = 15 }
				emperor = { change_key = { lhs = numb_targets_privileges value = 1 } }
			}
			country_event = { id = HRE_mechanics.1003 days = 60 }			
			add_ruler_modifier = { name = emperor_privileges_cd_counts }
		}
	}	
}


###Response targets
country_event = {
	id = HRE_mechanics.1002
	title = HRE_mechanics.1002.t
	desc = HRE_mechanics.1002.d
	picture = HRE_eventPicture
	
	is_triggered_only = yes ### by 1001
	
	immediate = {
		hidden_effect = {		
			export_to_variable = {
				which = yearly_income_tribute_contr
				value = years_of_income
				who = ROOT			
			}
		}
	}
	
	### Give the money to get our privileges
	option = {
		name = "HRE_mechanics.1002.money"
		
		trigger = {
			years_of_income = 5
		}
		
		ai_chance = {
			factor = 90
		}
		custom_tooltip = "HRE_mechanics.1002.money.ctp"
		
		### Give 5 years of income to the emperor
		hidden_effect = {		
			multiply_key = { lhs = yearly_income_tribute_contr value = 5 }
			
			set_key = { lhs = supplied_money_privileges which = yearly_income_tribute_contr }

			emperor = { 
				change_key = { lhs = supplied_money_privileges which = PREV } 
				change_key = { lhs = numb_targets_privileges_aggreed value = 1 }
			}
			
			while = {
				limit = {
					check_key = { lhs = yearly_income_tribute_contr value = 0 }
				}
				add_treasury = -1
				
				subtract_key = { lhs = yearly_income_tribute_contr value = 1 }
			}
		}
	}
	
	option = {
		name = "HRE_mechanics.1002.refuse"
		custom_tooltip = "HRE_mechanics.1002.refuse.ctp"
	
		ai_chance = {
			factor = 10
		}
	
		clr_country_flag = target_for_confirming_privileges
		
		reverse_add_opinion = {
			who = ROOT
			modifier = refused_paying_for_privileges
		}
	}
}


###Result - Emperor
country_event = {
	id = HRE_mechanics.1003
	title = HRE_mechanics.1003.t
	desc = HRE_mechanics.1003.d
	picture = HRE_eventPicture
	
	is_triggered_only = yes ### by 1002

	immediate = {
		hidden_effect = {
			every_country = {
				limit = {
					has_country_flag = target_for_confirming_privileges
				}
				add_country_modifier = { name = imperial_immediacy duration = 12775 }
			}
		}
	}
	
	
	option = {
		name = "HRE_mechanics.1003.a"
		
		hidden_effect = {
			while = {
				limit = {
					check_key = { lhs = supplied_money_privileges value = 0 }
				}
				add_treasury = 1
				
				subtract_key = { lhs = supplied_money_privileges value = 1 }
			}					
		}
		clear_privileges_variables = yes		
	}	
}

###Ask for privileges - Princes & counts
country_event = {
	id = HRE_mechanics.1004
	title = HRE_mechanics.1004.t
	desc = HRE_mechanics.1004.d
	picture = HRE_eventPicture
	
	is_triggered_only = yes ### from estate interaction	
	
	### Give him a lot of money - 7.5 years of income
	option = {
		name = "HRE_mechanics.1004.a"
		
		emperor = { 
			country_event = { id = HRE_mechanics.1005 days = 14 }
			set_country_flag = HRE_privilegs_alot_money_proposed
		}
		
		set_country_flag = target_for_confirming_privileges
	}
	
	### Give him a lot of money - 5 years of income
	option = {
		name = "HRE_mechanics.1004.b"
		
		emperor = { 
			country_event = { id = HRE_mechanics.1005 days = 14 } 
			set_country_flag = HRE_privilegs_normal_money_proposed
		}
		set_country_flag = target_for_confirming_privileges	
	}
	
	### Give less than usual - 2.5 years of income
	option = {
		name = "HRE_mechanics.1004.c"
		
		emperor = { 
			country_event = { id = HRE_mechanics.1005 days = 14 } 
			set_country_flag = HRE_privilegs_less_money_proposed		
		}
		set_country_flag = target_for_confirming_privileges
	}	
}


###Think over proposed money - Emperor
country_event = {
	id = HRE_mechanics.1005
	title = HRE_mechanics.1005.t
	desc = HRE_mechanics.1005.d
	picture = HRE_eventPicture
	
	is_triggered_only = yes ### by 1004

	immediate = {
		if = {
			limit = {
				has_country_flag = HRE_privilegs_alot_money_proposed
			}
			custom_tooltip = HRE_mechanics.1005.ctp1
		}
		if = {
			limit = {
				has_country_flag = HRE_privilegs_normal_money_proposed
			}
			custom_tooltip = HRE_mechanics.1005.ctp2
		}
		if = {
			limit = {
				has_country_flag = HRE_privilegs_less_money_proposed
			}
			custom_tooltip = HRE_mechanics.1005.ctp3
		}
	}
	
	### accept proposal
	option = {
		name = "HRE_mechanics.1005.accept"
		
		ai_chance = {
			factor = 95
		}
		
		#hidden_effect = {
			FROM = {
				add_country_modifier = { name = imperial_immediacy duration = 12775 }
				country_event = { id = HRE_mechanics.1006 days = 14 }
				clr_country_flag = target_for_confirming_privileges	
					
		#}
			}
	}
	
	### Decline Proposal
	option = {
		name = "HRE_mechanics.1005.refuse"
		
		ai_chance = {
			factor = 5
		}
		clr_country_flag = target_for_confirming_privileges	
		country_event = { id = HRE_mechanics.1007 days = 14 }
	
	}

}

### positive Result - princes
country_event = {
	id = HRE_mechanics.1006
	title = HRE_mechanics.1006.t
	desc = HRE_mechanics.1006.d
	picture = HRE_eventPicture
	
	is_triggered_only = yes ### by 1005

	immediate = {
		hidden_effect = {		
			export_to_variable = {
				which = yearly_income_tribute_contr
				value = years_of_income
				who = ROOT			
			}
		}	
	}

	
	option = {
		name = "HRE_mechanics.1006.a"
		
		ai_chance = {
			factor = 100
		}
		
		
		if = {
			limit = {
				has_country_flag = HRE_privilegs_alot_money_proposed
			}
			multiply_key = { lhs = yearly_income_tribute_contr value = 7.5 }
		}
        
		if = {
			limit = {
				has_country_flag = HRE_privilegs_normal_money_proposed
			}
			multiply_key = { lhs = yearly_income_tribute_contr value = 5 }
		}
		if = {
			limit = {
				has_country_flag = HRE_privilegs_less_money_proposed
			}
			multiply_key = { lhs = yearly_income_tribute_contr value = 2.5 }
		}
		
		custom_tooltip = HRE_mechanics.1006.ctp1

		clr_country_flag = HRE_privilegs_alot_money_proposed
		clr_country_flag = HRE_privilegs_normal_money_proposed
		clr_country_flag = HRE_privilegs_less_money_proposed
		
		set_key = { lhs = supplied_money_privileges which = yearly_income_tribute_contr }
        
		emperor = { 
			change_key = { lhs = supplied_money_privileges which = PREV } 
			country_event = { id = HRE_mechanics.1008 days = 14 }
		}
		
		while = {
			limit = {
				check_key = { lhs = yearly_income_tribute_contr value = 0 }
			}
			add_treasury = -1
		
			subtract_key = { lhs = yearly_income_tribute_contr value = 1 }
		}			
		
		

	}
}


### negative result - Princes
country_event = {
	id = HRE_mechanics.1007
	title = HRE_mechanics.1007.t
	desc = HRE_mechanics.1007.d
	picture = HRE_eventPicture
	
	is_triggered_only = yes ### by 1005
	
	
	###Damn him
	option = {
		name = "HRE_mechanics.1007.a"
		
	}
}

### Tribute arrives - Emperor
country_event = {
	id = HRE_mechanics.1008
	title = HRE_mechanics.1008.t
	desc = HRE_mechanics.1008.d
	picture = HRE_eventPicture

	is_triggered_only = yes ### by 1006

	option = {
		name = "HRE_mechanics.1008.a"
		
		while = {
			limit = {
				check_key = { lhs = supplied_money_privileges value = 0 }
			}
			add_treasury = 1
			
			subtract_key = { lhs = supplied_money_privileges value = 1 }
		}	
		clear_privileges_variables = yes
	}
}


##########################
### 003 KINGDOM MENUES ###
##########################

### Kingdom Policies Menu
country_event = {
	id = HRE_mechanics.2000
	title = HRE_mechanics.2000.t
	desc = HRE_mechanics.2000.d
	picture = HRE_eventPicture
	is_triggered_only = yes

	# Review Germany
	option = {
		name = HRE_mechanics.2000.a
		
		country_event = { id = HRE_mechanics.2100 } 
	}	
	
	# Review Italy
	option = {
		name = HRE_mechanics.2000.b
		
		country_event = { id = HRE_mechanics.2200 }
	}	
	
	# Review Arles
	option = {
		name = HRE_mechanics.2000.c
		
		country_event = { id = HRE_mechanics.2300 }
	}		
	
	option = {
		name = exit
		highlight = yes
	}
	
}


### Germany Menu
country_event = {
	id = HRE_mechanics.2100
	title = HRE_mechanics.2100.t
	desc = HRE_mechanics.2100.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	
	
	option = {
		name = "HRE_mechanics.2100.current"
		
		highlight = yes

		if = {
			limit = { has_global_flag = HRE_KP_GER_SI }
			custom_tooltip = "HRE_mechanics.KP.strong_interference_current_ctp"
		}
		if = {
			limit = { has_global_flag = HRE_KP_GER_PI }
			custom_tooltip = "HRE_mechanics.KP.partial_interference_current_ctp"
		}
		if = {
			limit = { has_global_flag = HRE_KP_GER_NI }
			custom_tooltip = "HRE_mechanics.KP.no_interference_current_ctp"
		}
		
		hidden_effect = {
			country_event = { id = HRE_mechanics.2101 }
		}
	}

	option = {
		name = HRE_mechanics.2100.military_campaign
				
		trigger = { 
			NOT = { 
				has_ruler_modifier = HRE_Failed_Campaign_GER
				has_country_modifier = HRE_CP_GER_CD
				has_country_flag = HRE_EMP_PREP_MIL_CAMPAIGN
				has_country_flag = HRE_EMP_PREP_PEAC_CAMPAIGN
			}
			
			HRE_Centralization_Trigger = { amount = 20 }
			
			OR = {
				has_global_flag = HRE_KP_GER_SI
				has_global_flag = HRE_KP_GER_PI
			}
			### TODO
			# Germany: IF any country is rebellious/hostile or has other religion
		}
    
		set_country_flag = HRE_EMP_PREP_MIL_CAMPAIGN
    
		hidden_effect = {
			country_event = { id = HRE_Romzug.204 }
		}
	
	}
	
	option = {
		name = HRE_mechanics.2100.peaceful_campaign
		trigger = { 
			NOT = { 
				has_ruler_modifier = HRE_Failed_Campaign_GER
				has_country_modifier = HRE_CP_GER_CD
				has_country_flag = HRE_EMP_PREP_MIL_CAMPAIGN
				has_country_flag = HRE_EMP_PREP_PEAC_CAMPAIGN
			}
			
			HRE_Centralization_Trigger = { amount = 5 }

			OR = {
				has_global_flag = HRE_KP_GER_SI
				has_global_flag = HRE_KP_GER_NI
				has_global_flag = HRE_KP_GER_PI
			}
		}	
	
		set_country_flag = HRE_EMP_PREP_PEAC_CAMPAIGN
    
		hidden_effect = {
			country_event = { id = HRE_Romzug.204 }
		}	
	}
	
	option = {
		name = HRE_mechanics.2100.create_imperial_circle
	
		trigger = {
			has_global_flag = HRE_INST_IC_A
			OR = {
				has_global_flag = HRE_KP_GER_PI
				has_global_flag = HRE_KP_GER_SI
			}
		}
		
		### TODO
	}

	option = {
		name = HRE_mechanics.2100.integrate_into_reichstag
	
		trigger = {
			has_global_flag = HRE_INST_RT_A
			OR = {
				has_global_flag = HRE_KP_GER_PI
				has_global_flag = HRE_KP_GER_SI
			}
		}
		
		### TODO
		
	}	
	
	option = {
		name = HRE_mechanics.2100.build_imperial_administration
		
		trigger = {
			any_owned_province = {
				superregion = italy_superregion
			}
			OR = {
				has_global_flag = HRE_KP_GER_PI
				has_global_flag = HRE_KP_GER_SI
			}
		}
		
		### TODO 
		country_event = { id = HRE_Romzug.300 }
	
	}
	
	option = {
		name = back
		highlight = yes
		
		country_event = { id = HRE_mechanics.2000 }
	}
	
	option = {
		name = exit
		highlight = yes
	}
	
}	

### Emperors Germany Policy Menue
country_event = {
	id = HRE_mechanics.2101
	title = HRE_mechanics.2101.t
	desc = HRE_mechanics.2101.d
	picture = HRE_eventPicture
	
	is_triggered_only = yes ## by estate interaction
	
	trigger = {
		is_emperor = yes
	}
		
	option = {
		name = "HRE_mechanics.2101.strong_interference"
		
		trigger = {
			has_global_flag = HRE_KP_GER_PI
			NOT = { has_country_modifier = HRE_KP_GER_CD }
		}
		
		set_global_flag = HRE_KP_GER_SI 
		clr_global_flag = HRE_KP_GER_PI
			
		custom_tooltip = HRE_mechanics.2101.strong_interference.ctp
		
		hidden_effect = {
			every_country = {
				limit = {
					has_country_flag = HRE_KP_Hostile
				}
				add_opinion = {
					who = ROOT
					modifier = HRE_KP_SI_N
				}
			}
			
			every_country = {
				limit = {
					has_country_flag = HRE_KP_Friendly
				}
				add_opinion = {
					who = ROOT
					modifier = HRE_KP_SI_P
				}
			
			}
			
			every_owned_province = {
				limit = {
					superregion = germany_superregion 
					superregion = greater_austrian_circle_superregion
				}
				add_unrest = 10
			}	
			
			every_subject_country = {
				limit = { 
					capital_scope = { 
						OR = { 
							superregion = germany_superregion 
							superregion = greater_austrian_circle_superregion
						} 
					}
				}
				add_liberty_desire = 10
			}
			
			add_country_modifier = {
				name = HRE_KP_GER_CD
				duration = 5475
			}			
		}
	}
	
	option = {
		name = "HRE_mechanics.2101.partial_interference"
		
		trigger = {
			OR = {
				has_global_flag = HRE_KP_GER_SI
				has_global_flag = HRE_KP_GER_NI
			}
			NOT = { has_country_modifier = HRE_KP_GER_CD }
		}
		
		set_global_flag = HRE_KP_GER_PI 
		clr_global_flag = HRE_KP_GER_NI
		clr_global_flag = HRE_KP_GER_SI
		
		custom_tooltip = HRE_mechanics.2101.partial_interference.ctp
		
		hidden_effect = {
			every_country = {
				limit = {
					has_country_flag = HRE_KP_Hostile
				}
				add_opinion = {
					who = ROOT
					modifier = HRE_KP_PI_N
				}
			}
			
			every_country = {
				limit = {
					has_country_flag = HRE_KP_Friendly
				}
				add_opinion = {
					who = ROOT
					modifier = HRE_KP_PI_P
				}
			
			}
			
			add_country_modifier = {
				name = HRE_KP_GER_CD
				duration = 5475
			}
		}
	}	

	option = {
		name = "HRE_mechanics.2101.no_interference"
		
		trigger = {		
			has_global_flag = HRE_KP_GER_SI
			NOT = { has_country_modifier = HRE_KP_GER_CD }
		}
		
		custom_tooltip = HRE_mechanics.2101.no_interference.ctp
				
		set_global_flag = HRE_KP_GER_NI 
		clr_global_flag = HRE_KP_GER_PI
		
		hidden_effect = {
			every_country = {
				limit = {
					has_country_flag = HRE_KP_Hostile
				}
				add_opinion = {
					who = ROOT
					modifier = HRE_KP_NI_N
				}
			}
			
			every_country = {
				limit = {
					has_country_flag = HRE_KP_Friendly
				}
				add_opinion = {
					who = ROOT
					modifier = HRE_KP_NI_P
				}
			}
			
			add_country_modifier = {
				name = HRE_KP_GER_CD
				duration = 5475
			}
		}
	}

	option = {
		name = HRE_mechanics.2101.back
		
		country_event = { id = HRE_mechanics.2100 }
	}
	
}


### Kingdom of Italy Menu
country_event = {
	id = HRE_mechanics.2200
	title = HRE_mechanics.2200.t
	desc = HRE_mechanics.2200.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	
	
	option = {
		name = "HRE_mechanics.2200.current"
		
		highlight = yes

		if = {
			limit = { has_global_flag = HRE_KP_ITA_SI }
			custom_tooltip = "HRE_mechanics.KP.strong_interference_current_ctp"
		}
		if = {
			limit = { has_global_flag = HRE_KP_ITA_PI }
			custom_tooltip = "HRE_mechanics.KP.partial_interference_current_ctp"
		}
		if = {
			limit = { has_global_flag = HRE_KP_ITA_NI }
			custom_tooltip = "HRE_mechanics.KP.no_interference_current_ctp"
		}
		
		hidden_effect = { country_event = { id = HRE_mechanics.2201 } }
	}

	option = {
		name = HRE_mechanics.2200.military_romzug
				
		trigger = { 
			NOT = { 
				has_ruler_modifier = HRE_Failed_Campaign_ITA
				has_country_modifier = HRE_CP_ITA_CD
				has_country_flag = HRE_EMP_PREP_MIL_CAMPAIGN
				has_country_flag = HRE_EMP_PREP_PEAC_CAMPAIGN
			}
			
			HRE_Centralization_Trigger = { amount = 40 }
			
			OR = {
				has_global_flag = HRE_KP_ITA_SI
				has_global_flag = HRE_KP_ITA_PI
			}
		}
    		
		set_country_flag = HRE_EMP_PREP_MIL_CAMPAIGN
    
		hidden_effect = { country_event = { id = HRE_Romzug.204 } }
	
	}
	
	option = {
		name = HRE_mechanics.2200.peaceful_romzug
		trigger = { 
			NOT = { 
				has_ruler_modifier = HRE_Failed_Campaign_ITA
				has_country_modifier = HRE_CP_ITA_CD
				has_country_flag = HRE_EMP_PREP_MIL_CAMPAIGN
				has_country_flag = HRE_EMP_PREP_PEAC_CAMPAIGN
			}
			
			HRE_Centralization_Trigger = { amount = 20 }
			
			OR = {
				has_global_flag = HRE_KP_ITA_SI
				has_global_flag = HRE_KP_ITA_PI
				has_global_flag = HRE_KP_ITA_NI
			}
		}	
	
		set_country_flag = HRE_EMP_PREP_PEAC_CAMPAIGN
    
		hidden_effect = { country_event = { id = HRE_Romzug.204 } }
	}
	
	option = {
		name = HRE_mechanics.2200.create_imperial_circle
	
		trigger = {
			has_global_flag = HRE_INST_IC_A
			OR = {
				has_global_flag = HRE_KP_ITA_SI
				has_global_flag = HRE_KP_ITA_PI
			}
		}
		
		### TODO
	}

	option = {
		name = HRE_mechanics.2200.integrate_into_reichstag
	
		trigger = {
			has_global_flag = HRE_INST_RT_A
			OR = {
				has_global_flag = HRE_KP_ITA_SI
				has_global_flag = HRE_KP_ITA_PI
			}
		}
		
		### TODO
	}	
	
	option = {
		name = HRE_mechanics.2200.build_imperial_administration
		
		trigger = {
			any_owned_province = {
				superregion = italy_superregion
			}
			OR = {
				has_country_flag = HRE_KP_ITA_SI
				has_country_flag = HRE_KP_ITA_PI
			}
		}
		
		country_event = { id = HRE_Romzug.300 }
	
	}
	
	option = {
		name = back
		highlight = yes
		
		country_event = { id = HRE_mechanics.2000 }
	}

	option = {
		name = exit
		highlight = yes
	}	
}	



### Emperors Italy Policy Menue
country_event = {
	id = HRE_mechanics.2201
	title = HRE_mechanics.2201.t
	desc = HRE_mechanics.2201.d
	picture = HRE_eventPicture
	
	is_triggered_only = yes ## by estate interaction
	
	trigger = {
		is_emperor = yes
	}
		
	option = {
		name = "HRE_mechanics.2201.strong_interference"
		
		trigger = {
			has_global_flag = HRE_KP_ITA_PI
			NOT = { has_country_modifier = HRE_KP_ITA_CD }
		}
		
		set_global_flag = HRE_KP_ITA_SI 
		clr_global_flag = HRE_KP_ITA_PI
		
		
		custom_tooltip = HRE_mechanics.2201.strong_interference.ctp
		
		hidden_effect = {
			every_country = {
				limit = {
					has_country_flag = Hre_italy_guelfs
				}
				add_opinion = {
					who = ROOT
					modifier = HRE_KP_SI_N_GUELFS
				}
			}
			
			every_country = {
				limit = {
					has_country_flag = Hre_italy_ghibelines
				}
				add_opinion = {
					who = ROOT
					modifier = HRE_KP_SI_P_GHIBEL
				}
			
			}
			
			every_owned_province = {
				limit = {
					superregion = italy_superregion
				}
				add_unrest = 10
				
			}

			every_subject_country = {
				limit = { capital_scope = { superregion = italy_superregion } }
				
				add_liberty_desire = 10
			}
			
			add_country_modifier = {
				name = HRE_KP_ITA_CD
				duration = 5475
			}			
		}
	}
	
	option = {
		name = "HRE_mechanics.2201.partial_interference"
		
		trigger = {
			OR = {
				has_global_flag = HRE_KP_ITA_SI
				has_global_flag = HRE_KP_ITA_NI
			}
			NOT = { has_country_modifier = HRE_KP_ITA_CD }
		}
		
		set_global_flag = HRE_KP_ITA_PI 
		clr_global_flag = HRE_KP_ITA_NI
		clr_global_flag = HRE_KP_ITA_SI
		
		
		custom_tooltip = HRE_mechanics.2201.partial_interference.ctp
		
		hidden_effect = {
			every_country = {
				limit = {
					has_country_flag = Hre_italy_guelfs
				}
				add_opinion = {
					who = ROOT
					modifier = HRE_KP_PI_N_GUELFS
				}
			}
			
			every_country = {
				limit = {
					has_country_flag = Hre_italy_ghibelines
				}
				add_opinion = {
					who = ROOT
					modifier = HRE_KP_PI_P_GHIBEL
				}
			
			}
			
			add_country_modifier = {
				name = HRE_KP_ITA_CD
				duration = 5475
			}
		}
	}	

	option = {
		name = "HRE_mechanics.2201.no_interference"
		
		trigger = {		
			has_global_flag = HRE_KP_ITA_PI
			NOT = { has_country_modifier = HRE_KP_ITA_CD }
		}
		
		custom_tooltip = HRE_mechanics.2201.no_interference.ctp
				
		set_global_flag = HRE_KP_ITA_NI 
		clr_global_flag = HRE_KP_ITA_PI
		
		hidden_effect = {
			every_country = {
				limit = {
					has_country_flag = Hre_italy_guelfs
				}
				add_opinion = {
					who = ROOT
					modifier = HRE_KP_NI_N_GUELFS
				}
			}
			
			every_country = {
				limit = {
					has_country_flag = Hre_italy_ghibelines
				}
				add_opinion = {
					who = ROOT
					modifier = HRE_KP_NI_P_GHIBEL
				}
			
			}
			
			add_country_modifier = {
				name = HRE_KP_ITA_CD
				duration = 5475
			}
		}
	}

	option = {
		name = HRE_mechanics.2201.back
		
		country_event = { id = HRE_mechanics.2200 }
	}
}





### Kingdom of Arles Menu
country_event = {
	id = HRE_mechanics.2300
	title = HRE_mechanics.2300.t
	desc = HRE_mechanics.2300.d
	picture = HRE_eventPicture
	is_triggered_only = yes
	
	
	option = {
		name = "HRE_mechanics.2300.current"
		
		highlight = yes

		if = { limit = { has_global_flag = HRE_KP_ARL_SI }
			custom_tooltip = "HRE_mechanics.KP.strong_interference_current_ctp"
		}
		if = { limit = { has_global_flag = HRE_KP_ARL_PI }
			custom_tooltip = "HRE_mechanics.KP.partial_interference_current_ctp"
		}
		if = { limit = { has_global_flag = HRE_KP_ARL_NI }
			custom_tooltip = "HRE_mechanics.KP.no_interference_current_ctp"
		}
		
		hidden_effect = { country_event = { id = HRE_mechanics.2301 } }
	}

	option = {
		name = HRE_mechanics.2300.military_campaign
				
		trigger = { 
			NOT = { 
				has_ruler_modifier = HRE_Failed_Campaign_ARL
				has_country_modifier = HRE_CP_ARL_CD
				has_country_flag = HRE_EMP_PREP_MIL_CAMPAIGN
				has_country_flag = HRE_EMP_PREP_PEAC_CAMPAIGN
			}
			
			HRE_Centralization_Trigger = { amount = 40 }
			OR = {
				has_global_flag = HRE_KP_ARL_SI
				has_global_flag = HRE_KP_ARL_PI
			}
		}
   
		set_country_flag = HRE_EMP_PREP_MIL_CAMPAIGN
    
		hidden_effect = { country_event = { id = HRE_Romzug.204 } }
	
	}
	
	option = {
		name = HRE_mechanics.2300.peaceful_campaign
		trigger = { 
			NOT = { 
				has_ruler_modifier = HRE_Failed_Campaign_ARL
				has_country_modifier = HRE_CP_ARL_CD
				has_country_flag = HRE_EMP_PREP_MIL_CAMPAIGN
				has_country_flag = HRE_EMP_PREP_PEAC_CAMPAIGN
			}
			HRE_Centralization_Trigger = { amount = 20 }

			OR = {
				has_global_flag = HRE_KP_ARL_SI
				has_global_flag = HRE_KP_ARL_PI
				has_global_flag = HRE_KP_ARL_NI
			}
		}	
	
		set_country_flag = HRE_EMP_PREP_PEAC_CAMPAIGN
    
		hidden_effect = {
			country_event = { id = HRE_Romzug.204 }
		}	
	
	}
	
	option = {
		name = HRE_mechanics.2300.create_imperial_circle
	
		trigger = {
			has_global_flag = HRE_INST_IC_A

			OR = {
				has_global_flag = HRE_KP_ARL_SI
				has_global_flag = HRE_KP_ARL_PI
			}
		}
		
		### TODO
		
	}

	option = {
		name = HRE_mechanics.2300.integrate_into_reichstag
	
		trigger = {
			has_global_flag = HRE_INST_RT_A

			OR = {
				has_global_flag = HRE_KP_ARL_SI
				has_global_flag = HRE_KP_ARL_PI
			}
		}	
	}	
	
	option = {
		name = HRE_mechanics.2300.build_imperial_administration
		
		trigger = {
			any_owned_province = {
				### TODO correct regions
				# superregion = italy_superregion
			}

			OR = {
				has_global_flag = HRE_KP_ARL_SI
				has_global_flag = HRE_KP_ARL_PI
			}
		}
		
		country_event = { id = HRE_Romzug.300 }
	
	}
	
	option = {
		name = back
		highlight = yes
		
		country_event = { id = HRE_mechanics.2000 }
	}
	
	option = {
		name = exit
		highlight = yes
	}
	
}


### Emperors Arles/Burgundy Policy Menue
country_event = {
	id = HRE_mechanics.2301
	title = HRE_mechanics.2301.t
	desc = HRE_mechanics.2301.d
	picture = HRE_eventPicture
	
	is_triggered_only = yes ## by estate interaction
	
	trigger = {
		is_emperor = yes
	}
		
	option = {
		name = "HRE_mechanics.2301.strong_interference"
		
		trigger = {
			has_global_flag = HRE_KP_ARL_PI
			NOT = { has_country_modifier = HRE_KP_ARL_CD }
		}
		
		
		set_global_flag = HRE_KP_ARL_SI 
		clr_global_flag = HRE_KP_ARL_PI
				
		custom_tooltip = HRE_mechanics.2301.strong_interference.ctp
		
		hidden_effect = {
			every_country = {
				limit = {
					has_country_flag = HRE_KP_Hostile
				}
				add_opinion = {
					who = ROOT
					modifier = HRE_KP_SI_N
				}
			}
			
			every_country = {
				limit = {
					has_country_flag = HRE_KP_Friendly
				}
				add_opinion = {
					who = ROOT
					modifier = HRE_KP_SI_P
				}
			
			}
			
			every_owned_province = {
				limit = {
					#TODO: Regions of Kingdom of Arles
					#superregion = italy_superregion
				}
				add_unrest = 10
			}
			every_subject_country = {
				limit = {
					capital_scope = {
						#TODO: Regions of Kingdom of Arles
						#superregion = italy_superregion		
					}
				}
				add_liberty_desire = 10
			}
			
			add_country_modifier = {
				name = HRE_KP_ARL_CD
				duration = 5475
			}			
		}
	}
	
	option = {
		name = "HRE_mechanics.2301.partial_interference"
		
		#Change possible if you have either No or strong interference
		trigger = {
			ERG = {
				OR = {
					has_country_flag = HRE_KP_ARL_SI
					has_country_flag = HRE_KP_ARL_NI
				}
			}
			NOT = { has_country_modifier = HRE_KP_ARL_CD }
		}
		
		#Update Interference Flags
		set_global_flag = HRE_KP_ARL_PI 
		clr_global_flag = HRE_KP_ARL_NI
		clr_global_flag = HRE_KP_ARL_SI
				
		custom_tooltip = HRE_mechanics.2301.partial_interference.ctp
		
		hidden_effect = {
			every_country = {
				limit = {
					has_country_flag = HRE_KP_Hostile
				}
				add_opinion = {
					who = ROOT
					modifier = HRE_KP_PI_N
				}
			}
			
			every_country = {
				limit = {
					has_country_flag = HRE_KP_Friendly
				}
				add_opinion = {
					who = ROOT
					modifier = HRE_KP_PI_P
				}
			
			}
			
			add_country_modifier = {
				name = HRE_KP_ARL_CD
				duration = 5475
			}
		}
	}	

	option = {
		name = "HRE_mechanics.2301.no_interference"
		
		trigger = {		
			ERG = { has_country_flag = HRE_KP_ARL_PI }
			NOT = { has_country_modifier = HRE_KP_ARL_CD }
		}
		
		custom_tooltip = HRE_mechanics.2301.no_interference.ctp
				
		set_global_flag = HRE_KP_ARL_NI 
		clr_global_flag = HRE_KP_ARL_PI
	
		hidden_effect = {
			every_country = {
				limit = {
					has_country_flag = HRE_KP_Hostile
				}
				add_opinion = {
					who = ROOT
					modifier = HRE_KP_NI_P
				}
			}
			
			every_country = {
				limit = {
					has_country_flag = HRE_KP_Friendly
				}
				add_opinion = {
					who = ROOT
					modifier = HRE_KP_NI_N
				}
			
			}
			
			add_country_modifier = {
				name = HRE_KP_ARL_CD
				duration = 5475
			}
		}
	}

	option = {
		name = back
		
		country_event = { id = HRE_mechanics.2300 }
	}
	
}

### Ask for crown - Burgundy
country_event = {
	id = HRE_mechanics.2302
	title = HRE_mechanics.2302.t
	desc = HRE_mechanics.2302.d
	picture = HRE_eventPicture
	
	is_triggered_only = yes
	
	
	
	option = {
		name = "HRE_mechanics.1011.give_him_the_crown"
		
		add_ruler_modifier = { name = HRE_king_of_arles } 
		
	}
}