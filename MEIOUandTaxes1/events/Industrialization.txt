########################################
# Events for Industrializing countries
#
# written by Henrik Lohmander
#
# rewritten for M&T by Piterdaw
########################################

namespace = industrialization_events

### INVENTIONS ###

### THE ATMOSPHERIC ENGINE
country_event = {
	id = industrialization_events.1
	title = "industrialization_events.1.t"
	desc = "industrialization_events.1.d"
	picture = ATMOSPHERIC_ENGINE_eventPicture
	goto = invention_province
	
	major_trigger = { NOT = { any_country { has_country_flag = atmospheric_engine_flag } } }

	is_triggered_only = yes #on_bi_yearly_pulse on_actions
	
	trigger = {
		has_dlc = "Rule Britannia"
		has_institution = Academia
		OR = {
		    full_idea_group = economic_ideas
			full_idea_group = engineering_ideas
			full_idea_group = innovativeness_ideas
			full_idea_group = industrial_ideas
		}
		NOT = { has_country_flag = atmospheric_engine_flag } #Newcomen Engine
		any_owned_province = { #Mining province
			is_in_capital_area = yes
			Academia = 100
			OR = {
				has_province_flag = Industry_14Present #Coal
				has_province_flag = Industry_15Present #Metal
				has_province_flag = Industry_16Present #Rare Metals
				has_province_flag = Industry_17Present #Gold
				has_province_flag = Industry_18Present #Silver
			}
		}
	}
	
	immediate = {
		hidden_effect = {
			set_country_flag = atmospheric_engine_flag
			random_owned_province = {
				limit = {
					is_in_capital_area = yes
			        Academia = 100
			        OR = {
				        has_province_flag = Industry_14Present #Coal
				        has_province_flag = Industry_15Present #Metal
				        has_province_flag = Industry_16Present #Rare Metals
				        has_province_flag = Industry_17Present #Gold
				        has_province_flag = Industry_18Present #Silver
			        }
				}
				save_event_target_as = invention_province
			}
		}
	}
	
	option = {
		name = "industrialization_events.1.a"
		event_target:invention_province = {
			add_province_modifier = {
				name = "introduction_of_newcommen_engine"
				duration = 3650
			}
			add_institution_embracement = {
				which = Industrialisation
				value = 25
			}
		}
	}
}

### COKE BLAST FURNACES
country_event = {
	id = industrialization_events.2
	title = "industrialization_events.2.t"
	picture = URBANIZATION_eventPicture
	goto = invention_province
	
	major_trigger = { NOT = { any_country { has_country_flag = coke_blast_furnaces_flag } } }
	
	is_triggered_only = yes #on_bi_yearly_pulse on_actions
	
	desc = {
		trigger = { is_ENG_GBR_UEF = no }
		desc = industrialization_events.2.d
	}
	desc = {
		ttrigger = { is_ENG_GBR_UEF = yes }
		desc = industrialization_events.2.d.england
	}
	
	trigger = {
		has_dlc = "Rule Britannia"
		has_institution = Academia
		OR = {
		    full_idea_group = economic_ideas
			full_idea_group = engineering_ideas
			full_idea_group = innovativeness_ideas
			full_idea_group = industrial_ideas
		}
		NOT = { has_country_flag = coke_blast_furnaces_flag }
		any_owned_province = { #Iron mining province
			is_in_capital_area = yes
			Academia = 100
			has_province_flag = Industry_15Present #Metal
		}
	}
	
	immediate = {
		hidden_effect = {
			set_country_flag = coke_blast_furnaces_flag
			set_saved_name = {
				key = inventor_name
				type = advisor
				scope = ROOT
			}
			random_owned_province = {
				limit = {
					is_in_capital_area = yes
			        Academia = 100
			        has_province_flag = Industry_15Present #Metal
				}
				save_event_target_as = invention_province
			}
		}
	}
	
	option = {
		name = "industrialization_events.2.a"
		event_target:invention_province = {
			add_province_modifier = {
				name = "introduction_of_coke_blast_furnaces"
				duration = 3650
			}
			add_institution_embracement = {
				which = Industrialisation
				value = 25
			}
		}
	}
	after = {
		clear_saved_name = inventor_name
	}
}

### WATT STEAM ENGINE
country_event = {
	id = industrialization_events.3
	title = "industrialization_events.3.t"
	picture = ATMOSPHERIC_ENGINE_eventPicture
	goto = invention_province
	
	major_trigger = { NOT = { any_country { has_country_flag = watt_steam_engine_flag } } }
	
	is_triggered_only = yes #on_bi_yearly_pulse on_actions
	
	desc = {
		trigger = { is_ENG_GBR_UEF = no }
		desc = industrialization_events.3.d
	}
	desc = {
		trigger = { is_ENG_GBR_UEF = yes }
		desc = industrialization_events.3.d.england
	}
	
	trigger = {
		has_dlc = "Rule Britannia"
		has_institution = Academia
		OR = {
		    full_idea_group = economic_ideas
			full_idea_group = engineering_ideas
			full_idea_group = innovativeness_ideas
			full_idea_group = industrial_ideas
		}
		has_country_flag = atmospheric_engine_flag
		NOT = { has_country_flag = watt_steam_engine_flag }
		any_owned_province = {
			is_in_capital_area = yes
			Academia = 100
			OR = { #Mining or industrial province
				has_province_flag = Industry_14Present #Coal
				has_province_flag = Industry_15Present #Metal
				has_province_flag = Industry_16Present #Rare Metals
				has_province_flag = Industry_17Present #Gold
				has_province_flag = Industry_18Present #Silver
				has_province_modifier = PN_Important
				has_province_modifier = PN_Major
				has_province_modifier = PN_Dominant
			}
		}
	}
	
	immediate = {
		hidden_effect = {
			set_country_flag = watt_steam_engine_flag
			set_saved_name = {
				key = inventor_name
				type = advisor
				scope = ROOT
			}
			random_owned_province = {
				limit = {
					is_in_capital_area = yes
			        Academia = 100
			        OR = {
				        has_province_flag = Industry_14Present #Coal
				        has_province_flag = Industry_15Present #Metal
				        has_province_flag = Industry_16Present #Rare Metals
				        has_province_flag = Industry_17Present #Gold
				        has_province_flag = Industry_18Present #Silver
						has_province_modifier = PN_Important
				        has_province_modifier = PN_Major
				        has_province_modifier = PN_Dominant
			        }
				}
				save_event_target_as = invention_province
			}
		}
	}
	
	option = {
		name = "industrialization_events.3.a"
		event_target:invention_province = {
			add_province_modifier = {
				name = "introduction_of_watt_engine"
				duration = 3650
			}
			add_institution_embracement = {
				which = Industrialisation
				value = 50
			}
		}
	}
	after = {
		clear_saved_name = inventor_name
	}
}

### ROTERHAM PLOUGH
country_event = {
	id = industrialization_events.4
	title = "industrialization_events.4.t"
	desc = "industrialization_events.4.d"
	picture = INDUSTRIALIZATION_eventPicture
	goto = invention_province
	
	major_trigger = { NOT = { any_country { has_country_flag = rotherham_plough_flag } } }
	
	is_triggered_only = yes #on_bi_yearly_pulse on_actions
	
	trigger = {
		has_dlc = "Rule Britannia"
		has_institution = Academia
		OR = {
		    full_idea_group = economic_ideas
			full_idea_group = engineering_ideas
			full_idea_group = innovativeness_ideas
			full_idea_group = agrarian_ideas
		}
		NOT = { has_country_flag = rotherham_plough_flag }
		any_owned_province = {
			is_in_capital_area = yes
			Academia = 100
			has_province_flag = Industry_1Present #Crop
			HasBuildingOrBetter = { b1=rural_infrastructure_3 b2=rural_infrastructure_4 b3=rural_infrastructure_5 b4=rural_infrastructure_6 b5=rural_infrastructure_7 }
		}
	}
	
	immediate = {
		hidden_effect = {
			set_country_flag = rotherham_plough_flag
			set_saved_name = {
				key = inventor_name
				type = advisor
				scope = ROOT
			}
			random_owned_province = {
				limit = {
					is_in_capital_area = yes
			        Academia = 100
			        has_province_flag = Industry_1Present #Crop
			        HasBuildingOrBetter = { b1=rural_infrastructure_3 b2=rural_infrastructure_4 b3=rural_infrastructure_5 b4=rural_infrastructure_6 b5=rural_infrastructure_7 }
				}
				save_event_target_as = invention_province
			}
		}
	}
	
	option = {
		name = "industrialization_events.4.a"
		event_target:invention_province = {
			add_province_modifier = {
				name = introduction_of_rotherham_plough
				duration = 3650
			}
			add_institution_embracement = {
				which = Industrialisation
				value = 25
			}
		}
	}
	after = {
		clear_saved_name = inventor_name
	}
}

### FLYING SHUTTLE
country_event = {
	id = industrialization_events.5
	title = "industrialization_events.5.t"
	desc = "industrialization_events.5.d"
	picture = TEXTILE_INDUSTRY_eventPicture
	goto = invention_province
	
	major_trigger = { NOT = { any_country { has_country_flag = flying_shuttle_flag } } }
	
	is_triggered_only = yes #on_bi_yearly_pulse on_actions
	
	trigger = {
		has_dlc = "Rule Britannia"
		has_institution = Academia
		OR = {
		    full_idea_group = economic_ideas
			full_idea_group = engineering_ideas
			full_idea_group = innovativeness_ideas
			full_idea_group = industrial_ideas
		}
		NOT = { has_country_flag = flying_shuttle_flag }
		any_owned_province = {
			is_in_capital_area = yes
			Academia = 100
			OR = { #Major centre of textile production
			    has_province_flag = Industry_25Present #Textile
			    has_province_flag = Industry_39Present #Luxury Cloth
			}
			OR = {
				has_province_modifier = PN_Important
				has_province_modifier = PN_Major
				has_province_modifier = PN_Dominant
			}
		}
	}
	
	immediate = {
		hidden_effect = {
			set_country_flag = flying_shuttle_flag
			random_owned_province = {
				limit = {
					is_in_capital_area = yes
					Academia = 100
					OR = { #Major centre of textile production
			            has_province_flag = Prod_AddProduceHelper25 #Textile
			            has_province_flag = Industry_39Present #Luxury Cloth
			        }
			        OR = {
				        has_province_modifier = PN_Important
				        has_province_modifier = PN_Major
				        has_province_modifier = PN_Dominant
			       }        
				}
				save_event_target_as = invention_province
			}
			set_saved_name = {
				key = inventor_name
				type = advisor
				scope = ROOT
			}
		}
	}
	
	option = {
		name = "industrialization_events.5.a"
		event_target:invention_province = {
			add_province_modifier = {
				name = introduction_of_flying_shuttle
				duration = 3650
			}
			add_institution_embracement = {
				which = Industrialisation
				value = 25
			}
		}
	}
	after = {
		clear_saved_name = inventor_name
	}
}

### SPINNING JENNY
country_event = {
	id = industrialization_events.6
	title = "industrialization_events.6.t"
	desc = "industrialization_events.6.d"
	picture = TEXTILE_INDUSTRY_eventPicture
	goto = invention_province
	
	major_trigger = { NOT = { any_country { has_country_flag = spinning_jenny_flag } } }
	
	is_triggered_only = yes #on_bi_yearly_pulse on_actions
	
	trigger = {
		has_dlc = "Rule Britannia"
		has_institution = Academia
		OR = {
		    full_idea_group = economic_ideas
			full_idea_group = engineering_ideas
			full_idea_group = innovativeness_ideas
			full_idea_group = industrial_ideas
		}
		has_country_flag = flying_shuttle_flag
		NOT = { has_country_flag = spinning_jenny_flag }
		any_owned_province = {
			is_in_capital_area = yes
			Academia = 100
			OR = { #Major centre of textile production
			    has_province_flag = Industry_25Present #Textile
			    has_province_flag = Industry_39Present #Luxury Cloth
			}
			OR = {
				has_province_modifier = PN_Important
				has_province_modifier = PN_Major
				has_province_modifier = PN_Dominant
			}
		}
	}
	
	immediate = {
		hidden_effect = {
			set_country_flag = spinning_jenny_flag
			random_owned_province = {
				limit = {
					is_in_capital_area = yes
					Academia = 100
					OR = { #Major centre of textile production
			            has_province_flag = Prod_AddProduceHelper25 #Textile
			            has_province_flag = Industry_39Present #Luxury Cloth
			        }
			        OR = {
				        has_province_modifier = PN_Important
				        has_province_modifier = PN_Major
				        has_province_modifier = PN_Dominant
			       }        
				}
				save_event_target_as = invention_province
			}
			set_saved_name = {
				key = inventor_name
				type = advisor
				scope = ROOT
			}
		}
	}
	
	option = {
		name = "industrialization_events.6.a"
		event_target:invention_province = {
			add_province_modifier = {
				name = introduction_of_spinning_jenny
				duration = 3650
			}
			add_institution_embracement = {
				which = Industrialisation
				value = 50
			}
		}
	}
	after = {
		clear_saved_name = inventor_name
	}
}
